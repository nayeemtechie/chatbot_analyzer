import{r as ie,a as Je,c as Ae,g as Ve}from"./vendor-DWzlYV2U.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&u(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(s){if(s.ep)return;s.ep=!0;const t=r(s);fetch(s.href,t)}})();var Ue={exports:{}},Ee={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe=ie,et=Symbol.for("react.element"),tt=Symbol.for("react.fragment"),st=Object.prototype.hasOwnProperty,rt=Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nt={key:!0,ref:!0,__self:!0,__source:!0};function Pe(S,l,r){var u,s={},t=null,a=null;r!==void 0&&(t=""+r),l.key!==void 0&&(t=""+l.key),l.ref!==void 0&&(a=l.ref);for(u in l)st.call(l,u)&&!nt.hasOwnProperty(u)&&(s[u]=l[u]);if(S&&S.defaultProps)for(u in l=S.defaultProps,l)s[u]===void 0&&(s[u]=l[u]);return{$$typeof:et,type:S,key:t,ref:a,props:s,_owner:rt.current}}Ee.Fragment=tt;Ee.jsx=Pe;Ee.jsxs=Pe;Ue.exports=Ee;var e=Ue.exports,We,Be=Je;We=Be.createRoot,Be.hydrateRoot;const be={openai:{id:"openai",name:"OpenAI",models:[{id:"gpt-5-mini",name:"GPT-5 Mini",maxTokens:128e3},{id:"gpt-4o",name:"GPT-4o (Recommended)",maxTokens:128e3},{id:"gpt-4o-mini",name:"GPT-4o Mini",maxTokens:128e3},{id:"gpt-4-turbo",name:"GPT-4 Turbo",maxTokens:128e3}],endpoint:"https://api.openai.com/v1/chat/completions"},gemini:{id:"gemini",name:"Google Gemini",models:[{id:"gemini-1.5-pro",name:"Gemini 1.5 Pro (Recommended)",maxTokens:1e6},{id:"gemini-1.5-flash",name:"Gemini 1.5 Flash",maxTokens:1e6},{id:"gemini-2.0-flash-exp",name:"Gemini 2.0 Flash",maxTokens:1e6}],endpoint:"https://generativelanguage.googleapis.com/v1beta/models"},perplexity:{id:"perplexity",name:"Perplexity",models:[{id:"llama-3.1-sonar-large-128k-online",name:"Sonar Large (Online)",maxTokens:128e3},{id:"llama-3.1-sonar-small-128k-online",name:"Sonar Small (Online)",maxTokens:128e3},{id:"llama-3.1-sonar-huge-128k-online",name:"Sonar Huge (Online)",maxTokens:128e3}],endpoint:"https://api.perplexity.ai/chat/completions"}},it={b2c:{id:"b2c",name:"B2C",description:"Business to Consumer"},b2b:{id:"b2b",name:"B2B",description:"Business to Business"}},Re=[{id:"parsing",name:"Parsing Transcripts",icon:"üìÑ"},{id:"domain",name:"Analyzing Domain",icon:"üåê"},{id:"intents",name:"Discovering Intents",icon:"üéØ"},{id:"scoring",name:"Scoring Responses",icon:"üìä"},{id:"friction",name:"Detecting Issues",icon:"‚ö†Ô∏è"},{id:"recommendations",name:"Generating Recommendations",icon:"üí°"},{id:"report",name:"Compiling Report",icon:"üìã"}],ye={llmConfig:"chatbot_analyzer_llm_config",analysisHistory:"chatbot_analyzer_history",theme:"chatbot_analyzer_theme",results:"chatbot_analyzer_results",transcripts:"chatbot_analyzer_transcripts",businessContext:"chatbot_analyzer_business_context"},at=[{id:"siteInfo",name:"Site Info",icon:"üåê"},{id:"overview",name:"Session Overview",icon:"üìä"},{id:"queries",name:"Query Analysis",icon:"üîç"},{id:"userInsights",name:"User Insights",icon:"üë§"},{id:"issues",name:"Issues & Recommendations",icon:"‚ö†Ô∏è"}],Me={theme:"light",llmConfig:{provider:"openai",model:"gpt-4o",apiKey:"",isConnected:!1},uploadedFiles:[],parsedTranscripts:[],businessContext:{websiteUrl:"",businessModel:"b2c",industry:"",geography:"",additionalContext:"",websiteContent:null},analysis:{isRunning:!1,currentStage:null,progress:0,error:null},results:null,activeTab:"summary"},oe={SET_THEME:"SET_THEME",SET_LLM_CONFIG:"SET_LLM_CONFIG",SET_UPLOADED_FILES:"SET_UPLOADED_FILES",SET_PARSED_TRANSCRIPTS:"SET_PARSED_TRANSCRIPTS",SET_BUSINESS_CONTEXT:"SET_BUSINESS_CONTEXT",SET_ANALYSIS_STATE:"SET_ANALYSIS_STATE",SET_RESULTS:"SET_RESULTS",SET_ACTIVE_TAB:"SET_ACTIVE_TAB",RESET_ANALYSIS:"RESET_ANALYSIS"};function ot(S,l){switch(l.type){case oe.SET_THEME:return{...S,theme:l.payload};case oe.SET_LLM_CONFIG:return{...S,llmConfig:{...S.llmConfig,...l.payload}};case oe.SET_UPLOADED_FILES:return{...S,uploadedFiles:l.payload};case oe.SET_PARSED_TRANSCRIPTS:return{...S,parsedTranscripts:l.payload};case oe.SET_BUSINESS_CONTEXT:return{...S,businessContext:{...S.businessContext,...l.payload}};case oe.SET_ANALYSIS_STATE:return{...S,analysis:{...S.analysis,...l.payload}};case oe.SET_RESULTS:return{...S,results:l.payload};case oe.SET_ACTIVE_TAB:return{...S,activeTab:l.payload};case oe.RESET_ANALYSIS:return{...S,analysis:Me.analysis,results:null};default:return S}}const $e=ie.createContext(null);function lt({children:S}){const[l,r]=ie.useReducer(ot,Me,s=>{if(typeof window<"u"){const t=localStorage.getItem(ye.theme);if(t)s.theme=t;else{const b=window.matchMedia("(prefers-color-scheme: dark)").matches;s.theme=b?"dark":"light"}const a=localStorage.getItem(ye.llmConfig);if(a)try{const b=JSON.parse(a);s.llmConfig={...s.llmConfig,...b}}catch(b){console.error("Failed to parse saved LLM config:",b)}const i=sessionStorage.getItem(ye.results);if(i)try{s.results=JSON.parse(i),console.log("‚úÖ Restored analysis results from session")}catch(b){console.error("Failed to parse saved results:",b)}const o=sessionStorage.getItem(ye.transcripts);if(o)try{s.parsedTranscripts=JSON.parse(o),console.log("‚úÖ Restored transcripts from session:",s.parsedTranscripts.length)}catch(b){console.error("Failed to parse saved transcripts:",b)}const g=sessionStorage.getItem(ye.businessContext);if(g)try{s.businessContext={...s.businessContext,...JSON.parse(g)}}catch(b){console.error("Failed to parse saved business context:",b)}}return s});ie.useEffect(()=>{document.documentElement.setAttribute("data-theme",l.theme),localStorage.setItem(ye.theme,l.theme)},[l.theme]),ie.useEffect(()=>{const s={provider:l.llmConfig.provider,model:l.llmConfig.model};localStorage.setItem(ye.llmConfig,JSON.stringify(s))},[l.llmConfig.provider,l.llmConfig.model]),ie.useEffect(()=>{if(l.results)try{sessionStorage.setItem(ye.results,JSON.stringify(l.results))}catch(s){console.warn("Failed to save results to sessionStorage:",s)}},[l.results]),ie.useEffect(()=>{if(l.parsedTranscripts.length>0)try{sessionStorage.setItem(ye.transcripts,JSON.stringify(l.parsedTranscripts))}catch(s){console.warn("Failed to save transcripts to sessionStorage:",s)}},[l.parsedTranscripts]),ie.useEffect(()=>{if(l.businessContext.websiteUrl)try{sessionStorage.setItem(ye.businessContext,JSON.stringify(l.businessContext))}catch(s){console.warn("Failed to save business context to sessionStorage:",s)}},[l.businessContext]);const u={setTheme:s=>r({type:oe.SET_THEME,payload:s}),toggleTheme:()=>r({type:oe.SET_THEME,payload:l.theme==="light"?"dark":"light"}),setLLMConfig:s=>r({type:oe.SET_LLM_CONFIG,payload:s}),setUploadedFiles:s=>r({type:oe.SET_UPLOADED_FILES,payload:s}),addUploadedFiles:s=>r({type:oe.SET_UPLOADED_FILES,payload:[...l.uploadedFiles,...s]}),removeUploadedFile:s=>{const t=[...l.uploadedFiles];t.splice(s,1),r({type:oe.SET_UPLOADED_FILES,payload:t})},setParsedTranscripts:s=>r({type:oe.SET_PARSED_TRANSCRIPTS,payload:s}),setBusinessContext:s=>r({type:oe.SET_BUSINESS_CONTEXT,payload:s}),setAnalysisState:s=>r({type:oe.SET_ANALYSIS_STATE,payload:s}),startAnalysis:()=>r({type:oe.SET_ANALYSIS_STATE,payload:{isRunning:!0,progress:0,error:null}}),updateProgress:(s,t)=>r({type:oe.SET_ANALYSIS_STATE,payload:{currentStage:s,progress:t}}),finishAnalysis:()=>r({type:oe.SET_ANALYSIS_STATE,payload:{isRunning:!1,progress:100}}),setAnalysisError:s=>r({type:oe.SET_ANALYSIS_STATE,payload:{isRunning:!1,error:s}}),setResults:s=>r({type:oe.SET_RESULTS,payload:s}),setActiveTab:s=>r({type:oe.SET_ACTIVE_TAB,payload:s}),resetAnalysis:()=>r({type:oe.RESET_ANALYSIS})};return e.jsx($e.Provider,{value:{state:l,actions:u},children:S})}function _e(){const S=ie.useContext($e);if(!S)throw new Error("useApp must be used within an AppProvider");return S}class qe extends ie.Component{constructor(l){super(l),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(l){return{hasError:!0}}componentDidCatch(l,r){console.error("ErrorBoundary caught an error:",l,r),this.setState({error:l,errorInfo:r})}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"24px",margin:"20px",background:"linear-gradient(135deg, #fee2e2, #fecaca)",borderRadius:"12px",border:"2px solid #ef4444",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[e.jsxs("h2",{style:{color:"#b91c1c",margin:"0 0 16px 0",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{children:"üö®"})," Something went wrong"]}),e.jsxs("div",{style:{background:"#fff",padding:"16px",borderRadius:"8px",marginBottom:"16px"},children:[e.jsx("h3",{style:{color:"#dc2626",margin:"0 0 8px 0",fontSize:"14px"},children:"Error Message:"}),e.jsx("pre",{style:{background:"#1e293b",color:"#f87171",padding:"12px",borderRadius:"6px",fontSize:"13px",overflow:"auto",margin:0},children:this.state.error&&this.state.error.toString()})]}),this.state.errorInfo&&e.jsxs("div",{style:{background:"#fff",padding:"16px",borderRadius:"8px",marginBottom:"16px"},children:[e.jsx("h3",{style:{color:"#dc2626",margin:"0 0 8px 0",fontSize:"14px"},children:"Component Stack:"}),e.jsx("pre",{style:{background:"#1e293b",color:"#94a3b8",padding:"12px",borderRadius:"6px",fontSize:"11px",overflow:"auto",margin:0,maxHeight:"200px"},children:this.state.errorInfo.componentStack})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:[e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"10px 20px",background:"#ef4444",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px"},children:"üîÑ Reload Page"}),e.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:null,errorInfo:null})},style:{padding:"10px 20px",background:"#64748b",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px"},children:"‚Ü©Ô∏è Try Again"}),e.jsx("button",{onClick:()=>{var r,u,s;const l={error:(r=this.state.error)==null?void 0:r.toString(),stack:(u=this.state.error)==null?void 0:u.stack,componentStack:(s=this.state.errorInfo)==null?void 0:s.componentStack};navigator.clipboard.writeText(JSON.stringify(l,null,2)),alert("Error details copied to clipboard!")},style:{padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"14px"},children:"üìã Copy Error"})]}),e.jsx("p",{style:{color:"#7f1d1d",fontSize:"12px",marginTop:"16px"},children:"üí° Tip: Open browser console (F12) for more details. Check if the LLM returned valid JSON."})]}):this.props.children}}function ct(){const{state:S,actions:l}=_e(),{theme:r,llmConfig:u}=S;return e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header-left",children:[e.jsxs("svg",{className:"header-logo",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"headerGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#4F46E5",stopOpacity:1}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#7C3AED",stopOpacity:1}})]})}),e.jsx("rect",{width:"64",height:"64",rx:"14",fill:"url(#headerGrad)"}),e.jsx("path",{d:"M20 24h24c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2h-6l-6 6-6-6h-6c-1.1 0-2-.9-2-2V26c0-1.1.9-2 2-2z",fill:"white",opacity:"0.9"}),e.jsx("circle",{cx:"26",cy:"32",r:"2",fill:"#4F46E5"}),e.jsx("circle",{cx:"32",cy:"32",r:"2",fill:"#4F46E5"}),e.jsx("circle",{cx:"38",cy:"32",r:"2",fill:"#4F46E5"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title",children:"Chatbot Analyzer"}),e.jsx("p",{className:"header-subtitle",children:"Transcript Analysis & Optimization"})]})]}),e.jsxs("div",{className:"header-right",children:[e.jsxs("div",{className:"header-status",children:[e.jsx("span",{className:`header-status-dot ${u.isConnected?"connected":""}`}),e.jsx("span",{children:u.isConnected?`${u.provider.toUpperCase()} Connected`:"Not Connected"})]}),e.jsx("button",{className:"theme-toggle",onClick:l.toggleTheme,"aria-label":`Switch to ${r==="light"?"dark":"light"} theme`,children:r==="light"?"üåô":"‚òÄÔ∏è"})]})]})}class dt{constructor(){this.provider=null,this.model=null,this.apiKey=null}configure(l,r,u){this.provider=l,this.model=r,this.apiKey=u}async testConnection(){if(!this.apiKey)throw new Error("API key not configured");try{const l=await this.complete('Say "Connected" if you can read this.',{maxTokens:10});return l.includes("Connected")||l.length>0}catch(l){throw new Error(`Connection failed: ${l.message}`)}}async complete(l,r={}){if(!this.provider||!this.apiKey)throw new Error("LLM service not configured");const{maxTokens:u=4096,temperature:s=.3}=r;switch(this.provider){case"openai":return this.completeOpenAI(l,u,s);case"gemini":return this.completeGemini(l,u,s);case"perplexity":return this.completePerplexity(l,u,s);default:throw new Error(`Unknown provider: ${this.provider}`)}}async completeOpenAI(l,r,u){var a;const s=await fetch(be.openai.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"system",content:"You are an expert chatbot analyst. Always respond with valid JSON when requested."},{role:"user",content:l}],max_tokens:r,temperature:u})});if(!s.ok){const i=await s.json().catch(()=>({}));throw new Error(((a=i.error)==null?void 0:a.message)||`OpenAI API error: ${s.status}`)}return(await s.json()).choices[0].message.content}async completeGemini(l,r,u){var i;const s=`${be.gemini.endpoint}/${this.model}:generateContent?key=${this.apiKey}`,t=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:l}]}],generationConfig:{temperature:u,maxOutputTokens:r}})});if(!t.ok){const o=await t.json().catch(()=>({}));throw new Error(((i=o.error)==null?void 0:i.message)||`Gemini API error: ${t.status}`)}return(await t.json()).candidates[0].content.parts[0].text}async completePerplexity(l,r,u){var a;const s=await fetch(be.perplexity.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"system",content:"You are an expert chatbot analyst. Always respond with valid JSON when requested."},{role:"user",content:l}],max_tokens:r,temperature:u})});if(!s.ok){const i=await s.json().catch(()=>({}));throw new Error(((a=i.error)==null?void 0:a.message)||`Perplexity API error: ${s.status}`)}return(await s.json()).choices[0].message.content}async*streamComplete(l,r={}){if(!this.provider||!this.apiKey)throw new Error("LLM service not configured");const{maxTokens:u=4096,temperature:s=.3}=r;this.provider==="openai"?yield*this.streamOpenAI(l,u,s):yield await this.complete(l,r)}async*streamOpenAI(l,r,u){var o,g,b;const s=await fetch(be.openai.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"system",content:"You are an expert chatbot analyst. Always respond with valid JSON when requested."},{role:"user",content:l}],max_tokens:r,temperature:u,stream:!0})});if(!s.ok){const f=await s.json().catch(()=>({}));throw new Error(((o=f.error)==null?void 0:o.message)||`OpenAI API error: ${s.status}`)}const t=s.body.getReader(),a=new TextDecoder;let i="";for(;;){const{done:f,value:p}=await t.read();if(f)break;i+=a.decode(p,{stream:!0});const d=i.split(`
`);i=d.pop()||"";for(const y of d)if(y.startsWith("data: ")){const h=y.slice(6);if(h==="[DONE]")return;try{const m=(b=(g=JSON.parse(h).choices[0])==null?void 0:g.delta)==null?void 0:b.content;m&&(yield m)}catch{}}}}parseJsonResponse(l){let r=l.trim();r.startsWith("```")&&(r=r.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));try{return JSON.parse(r)}catch(u){throw console.error("Failed to parse JSON response:",u),console.error("Response was:",r),new Error("Failed to parse LLM response as JSON")}}estimateTokens(l){return Math.ceil((l||"").length/4)}estimateCost(l,r){var i;const s=(i={openai:{"gpt-4o":{input:2.5,output:10},"gpt-4o-mini":{input:.15,output:.6},"gpt-4-turbo":{input:10,output:30}},gemini:{"gemini-1.5-pro":{input:1.25,output:5},"gemini-1.5-flash":{input:.075,output:.3},"gemini-2.0-flash-exp":{input:.075,output:.3}},perplexity:{"llama-3.1-sonar-large-128k-online":{input:1,output:1},"llama-3.1-sonar-small-128k-online":{input:.2,output:.2},"llama-3.1-sonar-huge-128k-online":{input:5,output:5}}}[this.provider])==null?void 0:i[this.model];if(!s)return null;const t=l/1e6*s.input,a=r/1e6*s.output;return{inputCost:t,outputCost:a,totalCost:t+a,currency:"USD"}}}const xe=new dt;function ut(){const{state:S,actions:l}=_e(),{llmConfig:r}=S,[u,s]=ie.useState(!1),[t,a]=ie.useState(!1),[i,o]=ie.useState(null),g=y=>{var m,x;const h=y.target.value,v=((x=(m=be[h])==null?void 0:m.models[0])==null?void 0:x.id)||"";l.setLLMConfig({provider:h,model:v,isConnected:!1}),o(null)},b=y=>{l.setLLMConfig({model:y.target.value,isConnected:!1}),o(null)},f=y=>{l.setLLMConfig({apiKey:y.target.value,isConnected:!1}),o(null)},p=async()=>{if(!r.apiKey){o({success:!1,message:"Please enter an API key"});return}a(!0),o(null);try{xe.configure(r.provider,r.model,r.apiKey),await xe.testConnection(),o({success:!0,message:"Connection successful!"}),l.setLLMConfig({isConnected:!0})}catch(y){o({success:!1,message:y.message}),l.setLLMConfig({isConnected:!1})}finally{a(!1)}},d=be[r.provider];return e.jsxs("div",{className:"config-panel",children:[e.jsxs("div",{className:"config-panel-header",children:[e.jsxs("h2",{className:"config-panel-title",children:[e.jsx("span",{className:"config-panel-title-icon",children:"‚öôÔ∏è"}),"LLM Configuration"]}),r.isConnected&&e.jsx("span",{className:"badge badge-success",children:"Connected"})]}),e.jsxs("div",{className:"config-panel-body",children:[e.jsxs("div",{className:"config-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"provider",children:"LLM Provider"}),e.jsx("select",{id:"provider",className:"form-select",value:r.provider,onChange:g,children:Object.values(be).map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"model",children:"Model"}),e.jsx("select",{id:"model",className:"form-select",value:r.model,onChange:b,children:d==null?void 0:d.models.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"apiKey",children:"API Key"}),e.jsxs("div",{className:"api-key-input-wrapper",children:[e.jsxs("div",{className:"api-key-input-group",children:[e.jsx("input",{id:"apiKey",type:u?"text":"password",className:"form-input",placeholder:`Enter your ${d==null?void 0:d.name} API key`,value:r.apiKey,onChange:f}),e.jsx("button",{type:"button",className:"api-key-toggle",onClick:()=>s(!u),"aria-label":u?"Hide API key":"Show API key",children:u?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è"})]}),e.jsx("button",{className:"btn btn-secondary test-connection-btn",onClick:p,disabled:t||!r.apiKey,children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Testing..."]}):"Test Connection"})]}),e.jsx("p",{className:"form-hint",children:"Your API key is stored locally in your browser and never sent to any server."})]}),i&&e.jsxs("div",{className:`connection-status ${i.success?"success":"error"}`,children:[e.jsx("span",{children:i.success?"‚úÖ":"‚ùå"}),e.jsx("span",{children:i.message})]}),e.jsxs("div",{className:"config-security-note",children:[e.jsx("span",{className:"config-security-note-icon",children:"üîí"}),e.jsx("span",{children:"API keys are stored in your browser's local storage. For production use, consider implementing a backend proxy to protect your API keys."})]}),e.jsxs("div",{className:"config-security-note config-privacy-note",children:[e.jsx("span",{className:"config-security-note-icon",children:"üõ°Ô∏è"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Data Privacy:"})," Your transcript data is sent directly to the LLM provider's API and is ",e.jsx("strong",{children:"not stored"})," on any server. Per OpenAI/Anthropic/Google API policies, data sent via API is ",e.jsx("strong",{children:"not used for model training"}),"."]})]})]})]})}function Ce(S){throw new Error('Could not dynamically require "'+S+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Qe={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(S,l){(function(r){S.exports=r()})(function(){return function r(u,s,t){function a(g,b){if(!s[g]){if(!u[g]){var f=typeof Ce=="function"&&Ce;if(!b&&f)return f(g,!0);if(i)return i(g,!0);var p=new Error("Cannot find module '"+g+"'");throw p.code="MODULE_NOT_FOUND",p}var d=s[g]={exports:{}};u[g][0].call(d.exports,function(y){var h=u[g][1][y];return a(h||y)},d,d.exports,r,u,s,t)}return s[g].exports}for(var i=typeof Ce=="function"&&Ce,o=0;o<t.length;o++)a(t[o]);return a}({1:[function(r,u,s){var t=r("./utils"),a=r("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(o){for(var g,b,f,p,d,y,h,v=[],m=0,x=o.length,k=x,A=t.getTypeOf(o)!=="string";m<o.length;)k=x-m,f=A?(g=o[m++],b=m<x?o[m++]:0,m<x?o[m++]:0):(g=o.charCodeAt(m++),b=m<x?o.charCodeAt(m++):0,m<x?o.charCodeAt(m++):0),p=g>>2,d=(3&g)<<4|b>>4,y=1<k?(15&b)<<2|f>>6:64,h=2<k?63&f:64,v.push(i.charAt(p)+i.charAt(d)+i.charAt(y)+i.charAt(h));return v.join("")},s.decode=function(o){var g,b,f,p,d,y,h=0,v=0,m="data:";if(o.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var x,k=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===i.charAt(64)&&k--,o.charAt(o.length-2)===i.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|k):new Array(0|k);h<o.length;)g=i.indexOf(o.charAt(h++))<<2|(p=i.indexOf(o.charAt(h++)))>>4,b=(15&p)<<4|(d=i.indexOf(o.charAt(h++)))>>2,f=(3&d)<<6|(y=i.indexOf(o.charAt(h++))),x[v++]=g,d!==64&&(x[v++]=b),y!==64&&(x[v++]=f);return x}},{"./support":30,"./utils":32}],2:[function(r,u,s){var t=r("./external"),a=r("./stream/DataWorker"),i=r("./stream/Crc32Probe"),o=r("./stream/DataLengthProbe");function g(b,f,p,d,y){this.compressedSize=b,this.uncompressedSize=f,this.crc32=p,this.compression=d,this.compressedContent=y}g.prototype={getContentWorker:function(){var b=new a(t.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),f=this;return b.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new a(t.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(b,f,p){return b.pipe(new i).pipe(new o("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new o("compressedSize")).withStreamInfo("compression",f)},u.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,u,s){var t=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new t("STORE compression")},uncompressWorker:function(){return new t("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,u,s){var t=r("./utils"),a=function(){for(var i,o=[],g=0;g<256;g++){i=g;for(var b=0;b<8;b++)i=1&i?3988292384^i>>>1:i>>>1;o[g]=i}return o}();u.exports=function(i,o){return i!==void 0&&i.length?t.getTypeOf(i)!=="string"?function(g,b,f,p){var d=a,y=p+f;g^=-1;for(var h=p;h<y;h++)g=g>>>8^d[255&(g^b[h])];return-1^g}(0|o,i,i.length,0):function(g,b,f,p){var d=a,y=p+f;g^=-1;for(var h=p;h<y;h++)g=g>>>8^d[255&(g^b.charCodeAt(h))];return-1^g}(0|o,i,i.length,0):0}},{"./utils":32}],5:[function(r,u,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,u,s){var t=null;t=typeof Promise<"u"?Promise:r("lie"),u.exports={Promise:t}},{lie:37}],7:[function(r,u,s){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=r("pako"),i=r("./utils"),o=r("./stream/GenericWorker"),g=t?"uint8array":"array";function b(f,p){o.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}s.magic="\b\0",i.inherits(b,o),b.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(i.transformTo(g,f.data),!1)},b.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},s.compressWorker=function(f){return new b("Deflate",f)},s.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,u,s){function t(d,y){var h,v="";for(h=0;h<y;h++)v+=String.fromCharCode(255&d),d>>>=8;return v}function a(d,y,h,v,m,x){var k,A,C=d.file,z=d.compression,L=x!==g.utf8encode,W=i.transformTo("string",x(C.name)),R=i.transformTo("string",g.utf8encode(C.name)),F=C.comment,K=i.transformTo("string",x(F)),j=i.transformTo("string",g.utf8encode(F)),B=R.length!==C.name.length,c=j.length!==F.length,U="",ee="",$="",te=C.dir,q=C.date,X={crc32:0,compressedSize:0,uncompressedSize:0};y&&!h||(X.crc32=d.crc32,X.compressedSize=d.compressedSize,X.uncompressedSize=d.uncompressedSize);var I=0;y&&(I|=8),L||!B&&!c||(I|=2048);var T=0,V=0;te&&(T|=16),m==="UNIX"?(V=798,T|=function(H,le){var he=H;return H||(he=le?16893:33204),(65535&he)<<16}(C.unixPermissions,te)):(V=20,T|=function(H){return 63&(H||0)}(C.dosPermissions)),k=q.getUTCHours(),k<<=6,k|=q.getUTCMinutes(),k<<=5,k|=q.getUTCSeconds()/2,A=q.getUTCFullYear()-1980,A<<=4,A|=q.getUTCMonth()+1,A<<=5,A|=q.getUTCDate(),B&&(ee=t(1,1)+t(b(W),4)+R,U+="up"+t(ee.length,2)+ee),c&&($=t(1,1)+t(b(K),4)+j,U+="uc"+t($.length,2)+$);var G="";return G+=`
\0`,G+=t(I,2),G+=z.magic,G+=t(k,2),G+=t(A,2),G+=t(X.crc32,4),G+=t(X.compressedSize,4),G+=t(X.uncompressedSize,4),G+=t(W.length,2),G+=t(U.length,2),{fileRecord:f.LOCAL_FILE_HEADER+G+W+U,dirRecord:f.CENTRAL_FILE_HEADER+t(V,2)+G+t(K.length,2)+"\0\0\0\0"+t(T,4)+t(v,4)+W+U+K}}var i=r("../utils"),o=r("../stream/GenericWorker"),g=r("../utf8"),b=r("../crc32"),f=r("../signature");function p(d,y,h,v){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=h,this.encodeFileName=v,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(p,o),p.prototype.push=function(d){var y=d.meta.percent||0,h=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,o.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:h?(y+100*(h-v-1))/h:100}}))},p.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var y=this.streamFiles&&!d.file.dir;if(y){var h=a(d,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(d){this.accumulate=!1;var y=this.streamFiles&&!d.file.dir,h=a(d,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),y)this.push({data:function(v){return f.DATA_DESCRIPTOR+t(v.crc32,4)+t(v.compressedSize,4)+t(v.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var d=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var h=this.bytesWritten-d,v=function(m,x,k,A,C){var z=i.transformTo("string",C(A));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+t(m,2)+t(m,2)+t(x,4)+t(k,4)+t(z.length,2)+z}(this.dirRecords.length,h,d,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(d){this._sources.push(d);var y=this;return d.on("data",function(h){y.processChunk(h)}),d.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),d.on("error",function(h){y.error(h)}),this},p.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(d){var y=this._sources;if(!o.prototype.error.call(this,d))return!1;for(var h=0;h<y.length;h++)try{y[h].error(d)}catch{}return!0},p.prototype.lock=function(){o.prototype.lock.call(this);for(var d=this._sources,y=0;y<d.length;y++)d[y].lock()},u.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,u,s){var t=r("../compressions"),a=r("./ZipFileWorker");s.generateWorker=function(i,o,g){var b=new a(o.streamFiles,g,o.platform,o.encodeFileName),f=0;try{i.forEach(function(p,d){f++;var y=function(x,k){var A=x||k,C=t[A];if(!C)throw new Error(A+" is not a valid compression method !");return C}(d.options.compression,o.compression),h=d.options.compressionOptions||o.compressionOptions||{},v=d.dir,m=d.date;d._compressWorker(y,h).withStreamInfo("file",{name:p,dir:v,date:m,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(b)}),b.entriesCount=f}catch(p){b.error(p)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,u,s){function t(){if(!(this instanceof t))return new t;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new t;for(var i in this)typeof this[i]!="function"&&(a[i]=this[i]);return a}}(t.prototype=r("./object")).loadAsync=r("./load"),t.support=r("./support"),t.defaults=r("./defaults"),t.version="3.10.1",t.loadAsync=function(a,i){return new t().loadAsync(a,i)},t.external=r("./external"),u.exports=t},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,u,s){var t=r("./utils"),a=r("./external"),i=r("./utf8"),o=r("./zipEntries"),g=r("./stream/Crc32Probe"),b=r("./nodejsUtils");function f(p){return new a.Promise(function(d,y){var h=p.decompressed.getContentWorker().pipe(new g);h.on("error",function(v){y(v)}).on("end",function(){h.streamInfo.crc32!==p.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}u.exports=function(p,d){var y=this;return d=t.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),b.isNode&&b.isStream(p)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):t.prepareContent("the loaded zip file",p,!0,d.optimizedBinaryString,d.base64).then(function(h){var v=new o(d);return v.load(h),v}).then(function(h){var v=[a.Promise.resolve(h)],m=h.files;if(d.checkCRC32)for(var x=0;x<m.length;x++)v.push(f(m[x]));return a.Promise.all(v)}).then(function(h){for(var v=h.shift(),m=v.files,x=0;x<m.length;x++){var k=m[x],A=k.fileNameStr,C=t.resolve(k.fileNameStr);y.file(C,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:d.createFolders}),k.dir||(y.file(C).unsafeOriginalName=A)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,u,s){var t=r("../utils"),a=r("../stream/GenericWorker");function i(o,g){a.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(g)}t.inherits(i,a),i.prototype._bindStream=function(o){var g=this;(this._stream=o).pause(),o.on("data",function(b){g.push({data:b,meta:{percent:0}})}).on("error",function(b){g.isPaused?this.generatedError=b:g.error(b)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},i.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,u,s){var t=r("readable-stream").Readable;function a(i,o,g){t.call(this,o),this._helper=i;var b=this;i.on("data",function(f,p){b.push(f)||b._helper.pause(),g&&g(p)}).on("error",function(f){b.emit("error",f)}).on("end",function(){b.push(null)})}r("../utils").inherits(a,t),a.prototype._read=function(){this._helper.resume()},u.exports=a},{"../utils":32,"readable-stream":16}],14:[function(r,u,s){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(t,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,a);if(typeof t=="number")throw new Error('The "data" argument must not be a number');return new Buffer(t,a)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var a=new Buffer(t);return a.fill(0),a},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&typeof t.on=="function"&&typeof t.pause=="function"&&typeof t.resume=="function"}}},{}],15:[function(r,u,s){function t(C,z,L){var W,R=i.getTypeOf(z),F=i.extend(L||{},b);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(C=m(C)),F.createFolders&&(W=v(C))&&x.call(this,W,!0);var K=R==="string"&&F.binary===!1&&F.base64===!1;L&&L.binary!==void 0||(F.binary=!K),(z instanceof f&&z.uncompressedSize===0||F.dir||!z||z.length===0)&&(F.base64=!1,F.binary=!0,z="",F.compression="STORE",R="string");var j=null;j=z instanceof f||z instanceof o?z:y.isNode&&y.isStream(z)?new h(C,z):i.prepareContent(C,z,F.binary,F.optimizedBinaryString,F.base64);var B=new p(C,j,F);this.files[C]=B}var a=r("./utf8"),i=r("./utils"),o=r("./stream/GenericWorker"),g=r("./stream/StreamHelper"),b=r("./defaults"),f=r("./compressedObject"),p=r("./zipObject"),d=r("./generate"),y=r("./nodejsUtils"),h=r("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var z=C.lastIndexOf("/");return 0<z?C.substring(0,z):""},m=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},x=function(C,z){return z=z!==void 0?z:b.createFolders,C=m(C),this.files[C]||t.call(this,C,null,{dir:!0,createFolders:z}),this.files[C]};function k(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var z,L,W;for(z in this.files)W=this.files[z],(L=z.slice(this.root.length,z.length))&&z.slice(0,this.root.length)===this.root&&C(L,W)},filter:function(C){var z=[];return this.forEach(function(L,W){C(L,W)&&z.push(W)}),z},file:function(C,z,L){if(arguments.length!==1)return C=this.root+C,t.call(this,C,z,L),this;if(k(C)){var W=C;return this.filter(function(F,K){return!K.dir&&W.test(F)})}var R=this.files[this.root+C];return R&&!R.dir?R:null},folder:function(C){if(!C)return this;if(k(C))return this.filter(function(R,F){return F.dir&&C.test(R)});var z=this.root+C,L=x.call(this,z),W=this.clone();return W.root=L.name,W},remove:function(C){C=this.root+C;var z=this.files[C];if(z||(C.slice(-1)!=="/"&&(C+="/"),z=this.files[C]),z&&!z.dir)delete this.files[C];else for(var L=this.filter(function(R,F){return F.name.slice(0,C.length)===C}),W=0;W<L.length;W++)delete this.files[L[W].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var z,L={};try{if((L=i.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");i.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var W=L.comment||this.comment||"";z=d.generateWorker(this,L,W)}catch(R){(z=new o("error")).error(R)}return new g(z,L.type||"string",L.mimeType)},generateAsync:function(C,z){return this.generateInternalStream(C).accumulate(z)},generateNodeStream:function(C,z){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(z)}};u.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,u,s){u.exports=r("stream")},{stream:void 0}],17:[function(r,u,s){var t=r("./DataReader");function a(i){t.call(this,i);for(var o=0;o<this.data.length;o++)i[o]=255&i[o]}r("../utils").inherits(a,t),a.prototype.byteAt=function(i){return this.data[this.zero+i]},a.prototype.lastIndexOfSignature=function(i){for(var o=i.charCodeAt(0),g=i.charCodeAt(1),b=i.charCodeAt(2),f=i.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===o&&this.data[p+1]===g&&this.data[p+2]===b&&this.data[p+3]===f)return p-this.zero;return-1},a.prototype.readAndCheckSignature=function(i){var o=i.charCodeAt(0),g=i.charCodeAt(1),b=i.charCodeAt(2),f=i.charCodeAt(3),p=this.readData(4);return o===p[0]&&g===p[1]&&b===p[2]&&f===p[3]},a.prototype.readData=function(i){if(this.checkOffset(i),i===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},u.exports=a},{"../utils":32,"./DataReader":18}],18:[function(r,u,s){var t=r("../utils");function a(i){this.data=i,this.length=i.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(i){this.checkIndex(this.index+i)},checkIndex:function(i){if(this.length<this.zero+i||i<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+i+"). Corrupted zip ?")},setIndex:function(i){this.checkIndex(i),this.index=i},skip:function(i){this.setIndex(this.index+i)},byteAt:function(){},readInt:function(i){var o,g=0;for(this.checkOffset(i),o=this.index+i-1;o>=this.index;o--)g=(g<<8)+this.byteAt(o);return this.index+=i,g},readString:function(i){return t.transformTo("string",this.readData(i))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var i=this.readInt(4);return new Date(Date.UTC(1980+(i>>25&127),(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(31&i)<<1))}},u.exports=a},{"../utils":32}],19:[function(r,u,s){var t=r("./Uint8ArrayReader");function a(i){t.call(this,i)}r("../utils").inherits(a,t),a.prototype.readData=function(i){this.checkOffset(i);var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},u.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,u,s){var t=r("./DataReader");function a(i){t.call(this,i)}r("../utils").inherits(a,t),a.prototype.byteAt=function(i){return this.data.charCodeAt(this.zero+i)},a.prototype.lastIndexOfSignature=function(i){return this.data.lastIndexOf(i)-this.zero},a.prototype.readAndCheckSignature=function(i){return i===this.readData(4)},a.prototype.readData=function(i){this.checkOffset(i);var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},u.exports=a},{"../utils":32,"./DataReader":18}],21:[function(r,u,s){var t=r("./ArrayReader");function a(i){t.call(this,i)}r("../utils").inherits(a,t),a.prototype.readData=function(i){if(this.checkOffset(i),i===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},u.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(r,u,s){var t=r("../utils"),a=r("../support"),i=r("./ArrayReader"),o=r("./StringReader"),g=r("./NodeBufferReader"),b=r("./Uint8ArrayReader");u.exports=function(f){var p=t.getTypeOf(f);return t.checkSupport(p),p!=="string"||a.uint8array?p==="nodebuffer"?new g(f):a.uint8array?new b(t.transformTo("uint8array",f)):new i(t.transformTo("array",f)):new o(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,u,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,u,s){var t=r("./GenericWorker"),a=r("../utils");function i(o){t.call(this,"ConvertWorker to "+o),this.destType=o}a.inherits(i,t),i.prototype.processChunk=function(o){this.push({data:a.transformTo(this.destType,o.data),meta:o.meta})},u.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(r,u,s){var t=r("./GenericWorker"),a=r("../crc32");function i(){t.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(i,t),i.prototype.processChunk=function(o){this.streamInfo.crc32=a(o.data,this.streamInfo.crc32||0),this.push(o)},u.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,u,s){var t=r("../utils"),a=r("./GenericWorker");function i(o){a.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}t.inherits(i,a),i.prototype.processChunk=function(o){if(o){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+o.data.length}a.prototype.processChunk.call(this,o)},u.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(r,u,s){var t=r("../utils"),a=r("./GenericWorker");function i(o){a.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(b){g.dataIsReady=!0,g.data=b,g.max=b&&b.length||0,g.type=t.getTypeOf(b),g.isPaused||g._tickAndRepeat()},function(b){g.error(b)})}t.inherits(i,a),i.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,t.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(t.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,g);break;case"uint8array":o=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":o=this.data.slice(this.index,g)}return this.index=g,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(r,u,s){function t(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}t.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,i){return this._listeners[a].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,i){if(this._listeners[a])for(var o=0;o<this._listeners[a].length;o++)this._listeners[a][o].call(this,i)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var i=this;return a.on("data",function(o){i.processChunk(o)}),a.on("end",function(){i.end()}),a.on("error",function(o){i.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,i){return this.extraStreamInfo[a]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},u.exports=t},{}],29:[function(r,u,s){var t=r("../utils"),a=r("./ConvertWorker"),i=r("./GenericWorker"),o=r("../base64"),g=r("../support"),b=r("../external"),f=null;if(g.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(y,h){return new b.Promise(function(v,m){var x=[],k=y._internalType,A=y._outputType,C=y._mimeType;y.on("data",function(z,L){x.push(z),h&&h(L)}).on("error",function(z){x=[],m(z)}).on("end",function(){try{var z=function(L,W,R){switch(L){case"blob":return t.newBlob(t.transformTo("arraybuffer",W),R);case"base64":return o.encode(W);default:return t.transformTo(L,W)}}(A,function(L,W){var R,F=0,K=null,j=0;for(R=0;R<W.length;R++)j+=W[R].length;switch(L){case"string":return W.join("");case"array":return Array.prototype.concat.apply([],W);case"uint8array":for(K=new Uint8Array(j),R=0;R<W.length;R++)K.set(W[R],F),F+=W[R].length;return K;case"nodebuffer":return Buffer.concat(W);default:throw new Error("concat : unsupported type '"+L+"'")}}(k,x),C);v(z)}catch(L){m(L)}x=[]}).resume()})}function d(y,h,v){var m=h;switch(h){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=h,this._mimeType=v,t.checkSupport(m),this._worker=y.pipe(new a(m)),y.lock()}catch(x){this._worker=new i("error"),this._worker.error(x)}}d.prototype={accumulate:function(y){return p(this,y)},on:function(y,h){var v=this;return y==="data"?this._worker.on(y,function(m){h.call(v,m.data,m.meta)}):this._worker.on(y,function(){t.delay(h,arguments,v)}),this},resume:function(){return t.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(t.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},y)}},u.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,u,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var t=new ArrayBuffer(0);try{s.blob=new Blob([t],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(t),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,u,s){for(var t=r("./utils"),a=r("./support"),i=r("./nodejsUtils"),o=r("./stream/GenericWorker"),g=new Array(256),b=0;b<256;b++)g[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;g[254]=g[254]=1;function f(){o.call(this,"utf-8 decode"),this.leftOver=null}function p(){o.call(this,"utf-8 encode")}s.utf8encode=function(d){return a.nodebuffer?i.newBufferFrom(d,"utf-8"):function(y){var h,v,m,x,k,A=y.length,C=0;for(x=0;x<A;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<A&&(64512&(m=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(m-56320),x++),C+=v<128?1:v<2048?2:v<65536?3:4;for(h=a.uint8array?new Uint8Array(C):new Array(C),x=k=0;k<C;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<A&&(64512&(m=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(m-56320),x++),v<128?h[k++]=v:(v<2048?h[k++]=192|v>>>6:(v<65536?h[k++]=224|v>>>12:(h[k++]=240|v>>>18,h[k++]=128|v>>>12&63),h[k++]=128|v>>>6&63),h[k++]=128|63&v);return h}(d)},s.utf8decode=function(d){return a.nodebuffer?t.transformTo("nodebuffer",d).toString("utf-8"):function(y){var h,v,m,x,k=y.length,A=new Array(2*k);for(h=v=0;h<k;)if((m=y[h++])<128)A[v++]=m;else if(4<(x=g[m]))A[v++]=65533,h+=x-1;else{for(m&=x===2?31:x===3?15:7;1<x&&h<k;)m=m<<6|63&y[h++],x--;1<x?A[v++]=65533:m<65536?A[v++]=m:(m-=65536,A[v++]=55296|m>>10&1023,A[v++]=56320|1023&m)}return A.length!==v&&(A.subarray?A=A.subarray(0,v):A.length=v),t.applyFromCharCode(A)}(d=t.transformTo(a.uint8array?"uint8array":"array",d))},t.inherits(f,o),f.prototype.processChunk=function(d){var y=t.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var h=y;(y=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),y.set(h,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(x,k){var A;for((k=k||x.length)>x.length&&(k=x.length),A=k-1;0<=A&&(192&x[A])==128;)A--;return A<0||A===0?k:A+g[x[A]]>k?A:k}(y),m=y;v!==y.length&&(a.uint8array?(m=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(m=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(m),meta:d.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=f,t.inherits(p,o),p.prototype.processChunk=function(d){this.push({data:s.utf8encode(d.data),meta:d.meta})},s.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,u,s){var t=r("./support"),a=r("./base64"),i=r("./nodejsUtils"),o=r("./external");function g(h){return h}function b(h,v){for(var m=0;m<h.length;++m)v[m]=255&h.charCodeAt(m);return v}r("setimmediate"),s.newBlob=function(h,v){s.checkSupport("blob");try{return new Blob([h],{type:v})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(h),m.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(h,v,m){var x=[],k=0,A=h.length;if(A<=m)return String.fromCharCode.apply(null,h);for(;k<A;)v==="array"||v==="nodebuffer"?x.push(String.fromCharCode.apply(null,h.slice(k,Math.min(k+m,A)))):x.push(String.fromCharCode.apply(null,h.subarray(k,Math.min(k+m,A)))),k+=m;return x.join("")},stringifyByChar:function(h){for(var v="",m=0;m<h.length;m++)v+=String.fromCharCode(h[m]);return v},applyCanBeUsed:{uint8array:function(){try{return t.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return t.nodebuffer&&String.fromCharCode.apply(null,i.allocBuffer(1)).length===1}catch{return!1}}()}};function p(h){var v=65536,m=s.getTypeOf(h),x=!0;if(m==="uint8array"?x=f.applyCanBeUsed.uint8array:m==="nodebuffer"&&(x=f.applyCanBeUsed.nodebuffer),x)for(;1<v;)try{return f.stringifyByChunk(h,m,v)}catch{v=Math.floor(v/2)}return f.stringifyByChar(h)}function d(h,v){for(var m=0;m<h.length;m++)v[m]=h[m];return v}s.applyFromCharCode=p;var y={};y.string={string:g,array:function(h){return b(h,new Array(h.length))},arraybuffer:function(h){return y.string.uint8array(h).buffer},uint8array:function(h){return b(h,new Uint8Array(h.length))},nodebuffer:function(h){return b(h,i.allocBuffer(h.length))}},y.array={string:p,array:g,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return i.newBufferFrom(h)}},y.arraybuffer={string:function(h){return p(new Uint8Array(h))},array:function(h){return d(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:g,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return i.newBufferFrom(new Uint8Array(h))}},y.uint8array={string:p,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:g,nodebuffer:function(h){return i.newBufferFrom(h)}},y.nodebuffer={string:p,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return y.nodebuffer.uint8array(h).buffer},uint8array:function(h){return d(h,new Uint8Array(h.length))},nodebuffer:g},s.transformTo=function(h,v){if(v=v||"",!h)return v;s.checkSupport(h);var m=s.getTypeOf(v);return y[m][h](v)},s.resolve=function(h){for(var v=h.split("/"),m=[],x=0;x<v.length;x++){var k=v[x];k==="."||k===""&&x!==0&&x!==v.length-1||(k===".."?m.pop():m.push(k))}return m.join("/")},s.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":t.nodebuffer&&i.isBuffer(h)?"nodebuffer":t.uint8array&&h instanceof Uint8Array?"uint8array":t.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(h){if(!t[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(h){var v,m,x="";for(m=0;m<(h||"").length;m++)x+="\\x"+((v=h.charCodeAt(m))<16?"0":"")+v.toString(16).toUpperCase();return x},s.delay=function(h,v,m){setImmediate(function(){h.apply(m||null,v||[])})},s.inherits=function(h,v){function m(){}m.prototype=v.prototype,h.prototype=new m},s.extend=function(){var h,v,m={};for(h=0;h<arguments.length;h++)for(v in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],v)&&m[v]===void 0&&(m[v]=arguments[h][v]);return m},s.prepareContent=function(h,v,m,x,k){return o.Promise.resolve(v).then(function(A){return t.blob&&(A instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A))!==-1)&&typeof FileReader<"u"?new o.Promise(function(C,z){var L=new FileReader;L.onload=function(W){C(W.target.result)},L.onerror=function(W){z(W.target.error)},L.readAsArrayBuffer(A)}):A}).then(function(A){var C=s.getTypeOf(A);return C?(C==="arraybuffer"?A=s.transformTo("uint8array",A):C==="string"&&(k?A=a.decode(A):m&&x!==!0&&(A=function(z){return b(z,t.uint8array?new Uint8Array(z.length):new Array(z.length))}(A))),A):o.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,u,s){var t=r("./reader/readerFor"),a=r("./utils"),i=r("./signature"),o=r("./zipEntry"),g=r("./support");function b(f){this.files=[],this.loadOptions=f}b.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(p)+", expected "+a.pretty(f)+")")}},isSignature:function(f,p){var d=this.reader.index;this.reader.setIndex(f);var y=this.reader.readString(4)===p;return this.reader.setIndex(d),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=g.uint8array?"uint8array":"array",d=a.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,p,d,y=this.zip64EndOfCentralSize-44;0<y;)f=this.reader.readInt(2),p=this.reader.readInt(4),d=this.reader.readData(p),this.zip64ExtensibleData[f]={id:f,length:p,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(f=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var p=f;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var y=p-d;if(0<y)this.isSignature(p,i.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(f){this.reader=t(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,u,s){var t=r("./reader/readerFor"),a=r("./utils"),i=r("./compressedObject"),o=r("./crc32"),g=r("./utf8"),b=r("./compressions"),f=r("./support");function p(d,y){this.options=d,this.loadOptions=y}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var y,h;if(d.skip(22),this.fileNameLength=d.readInt(2),h=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var m in b)if(Object.prototype.hasOwnProperty.call(b,m)&&b[m].magic===v)return b[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,y,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var y=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(y),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=t(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var y,h,v,m=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<m;)y=d.readInt(2),h=d.readInt(2),v=d.readData(h),this.extraFields[y]={id:y,length:h,value:v};d.setIndex(m)},handleUTF8:function(){var d=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var h=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var m=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var y=t(d.value);return y.readInt(1)!==1||o(this.fileName)!==y.readInt(4)?null:g.utf8decode(y.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var y=t(d.value);return y.readInt(1)!==1||o(this.fileComment)!==y.readInt(4)?null:g.utf8decode(y.readData(d.length-5))}return null}},u.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,u,s){function t(y,h,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=h,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=r("./stream/StreamHelper"),i=r("./stream/DataWorker"),o=r("./utf8"),g=r("./compressedObject"),b=r("./stream/GenericWorker");t.prototype={internalStream:function(y){var h=null,v="string";try{if(!y)throw new Error("No output type specified.");var m=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),h=this._decompressWorker();var x=!this._dataBinary;x&&!m&&(h=h.pipe(new o.Utf8EncodeWorker)),!x&&m&&(h=h.pipe(new o.Utf8DecodeWorker))}catch(k){(h=new b("error")).error(k)}return new a(h,v,"")},async:function(y,h){return this.internalStream(y).accumulate(h)},nodeStream:function(y,h){return this.internalStream(y||"nodebuffer").toNodejsStream(h)},_compressWorker:function(y,h){if(this._data instanceof g&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new o.Utf8EncodeWorker)),g.createWorkerFrom(v,y,h)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof b?this._data:new i(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<f.length;d++)t.prototype[f[d]]=p;u.exports=t},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,u,s){(function(t){var a,i,o=t.MutationObserver||t.WebKitMutationObserver;if(o){var g=0,b=new o(y),f=t.document.createTextNode("");b.observe(f,{characterData:!0}),a=function(){f.data=g=++g%2}}else if(t.setImmediate||t.MessageChannel===void 0)a="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var h=t.document.createElement("script");h.onreadystatechange=function(){y(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},t.document.documentElement.appendChild(h)}:function(){setTimeout(y,0)};else{var p=new t.MessageChannel;p.port1.onmessage=y,a=function(){p.port2.postMessage(0)}}var d=[];function y(){var h,v;i=!0;for(var m=d.length;m;){for(v=d,d=[],h=-1;++h<m;)v[h]();m=d.length}i=!1}u.exports=function(h){d.push(h)!==1||i||a()}}).call(this,typeof Ae<"u"?Ae:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,u,s){var t=r("immediate");function a(){}var i={},o=["REJECTED"],g=["FULFILLED"],b=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,m!==a&&h(this,m)}function p(m,x,k){this.promise=m,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function d(m,x,k){t(function(){var A;try{A=x(k)}catch(C){return i.reject(m,C)}A===m?i.reject(m,new TypeError("Cannot resolve promise with itself")):i.resolve(m,A)})}function y(m){var x=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof x=="function")return function(){x.apply(m,arguments)}}function h(m,x){var k=!1;function A(L){k||(k=!0,i.reject(m,L))}function C(L){k||(k=!0,i.resolve(m,L))}var z=v(function(){x(C,A)});z.status==="error"&&A(z.value)}function v(m,x){var k={};try{k.value=m(x),k.status="success"}catch(A){k.status="error",k.value=A}return k}(u.exports=f).prototype.finally=function(m){if(typeof m!="function")return this;var x=this.constructor;return this.then(function(k){return x.resolve(m()).then(function(){return k})},function(k){return x.resolve(m()).then(function(){throw k})})},f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,x){if(typeof m!="function"&&this.state===g||typeof x!="function"&&this.state===o)return this;var k=new this.constructor(a);return this.state!==b?d(k,this.state===g?m:x,this.outcome):this.queue.push(new p(k,m,x)),k},p.prototype.callFulfilled=function(m){i.resolve(this.promise,m)},p.prototype.otherCallFulfilled=function(m){d(this.promise,this.onFulfilled,m)},p.prototype.callRejected=function(m){i.reject(this.promise,m)},p.prototype.otherCallRejected=function(m){d(this.promise,this.onRejected,m)},i.resolve=function(m,x){var k=v(y,x);if(k.status==="error")return i.reject(m,k.value);var A=k.value;if(A)h(m,A);else{m.state=g,m.outcome=x;for(var C=-1,z=m.queue.length;++C<z;)m.queue[C].callFulfilled(x)}return m},i.reject=function(m,x){m.state=o,m.outcome=x;for(var k=-1,A=m.queue.length;++k<A;)m.queue[k].callRejected(x);return m},f.resolve=function(m){return m instanceof this?m:i.resolve(new this(a),m)},f.reject=function(m){var x=new this(a);return i.reject(x,m)},f.all=function(m){var x=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=m.length,A=!1;if(!k)return this.resolve([]);for(var C=new Array(k),z=0,L=-1,W=new this(a);++L<k;)R(m[L],L);return W;function R(F,K){x.resolve(F).then(function(j){C[K]=j,++z!==k||A||(A=!0,i.resolve(W,C))},function(j){A||(A=!0,i.reject(W,j))})}},f.race=function(m){var x=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=m.length,A=!1;if(!k)return this.resolve([]);for(var C=-1,z=new this(a);++C<k;)L=m[C],x.resolve(L).then(function(W){A||(A=!0,i.resolve(z,W))},function(W){A||(A=!0,i.reject(z,W))});var L;return z}},{immediate:36}],38:[function(r,u,s){var t={};(0,r("./lib/utils/common").assign)(t,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),u.exports=t},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,u,s){var t=r("./zlib/deflate"),a=r("./utils/common"),i=r("./utils/strings"),o=r("./zlib/messages"),g=r("./zlib/zstream"),b=Object.prototype.toString,f=0,p=-1,d=0,y=8;function h(m){if(!(this instanceof h))return new h(m);this.options=a.assign({level:p,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},m||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var k=t.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(k!==f)throw new Error(o[k]);if(x.header&&t.deflateSetHeader(this.strm,x.header),x.dictionary){var A;if(A=typeof x.dictionary=="string"?i.string2buf(x.dictionary):b.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(k=t.deflateSetDictionary(this.strm,A))!==f)throw new Error(o[k]);this._dict_set=!0}}function v(m,x){var k=new h(x);if(k.push(m,!0),k.err)throw k.msg||o[k.err];return k.result}h.prototype.push=function(m,x){var k,A,C=this.strm,z=this.options.chunkSize;if(this.ended)return!1;A=x===~~x?x:x===!0?4:0,typeof m=="string"?C.input=i.string2buf(m):b.call(m)==="[object ArrayBuffer]"?C.input=new Uint8Array(m):C.input=m,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(z),C.next_out=0,C.avail_out=z),(k=t.deflate(C,A))!==1&&k!==f)return this.onEnd(k),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||A!==4&&A!==2)||(this.options.to==="string"?this.onData(i.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&k!==1);return A===4?(k=t.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===f):A!==2||(this.onEnd(f),!(C.avail_out=0))},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},s.Deflate=h,s.deflate=v,s.deflateRaw=function(m,x){return(x=x||{}).raw=!0,v(m,x)},s.gzip=function(m,x){return(x=x||{}).gzip=!0,v(m,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,u,s){var t=r("./zlib/inflate"),a=r("./utils/common"),i=r("./utils/strings"),o=r("./zlib/constants"),g=r("./zlib/messages"),b=r("./zlib/zstream"),f=r("./zlib/gzheader"),p=Object.prototype.toString;function d(h){if(!(this instanceof d))return new d(h);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},h||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||h&&h.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var m=t.inflateInit2(this.strm,v.windowBits);if(m!==o.Z_OK)throw new Error(g[m]);this.header=new f,t.inflateGetHeader(this.strm,this.header)}function y(h,v){var m=new d(v);if(m.push(h,!0),m.err)throw m.msg||g[m.err];return m.result}d.prototype.push=function(h,v){var m,x,k,A,C,z,L=this.strm,W=this.options.chunkSize,R=this.options.dictionary,F=!1;if(this.ended)return!1;x=v===~~v?v:v===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof h=="string"?L.input=i.binstring2buf(h):p.call(h)==="[object ArrayBuffer]"?L.input=new Uint8Array(h):L.input=h,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new a.Buf8(W),L.next_out=0,L.avail_out=W),(m=t.inflate(L,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&R&&(z=typeof R=="string"?i.string2buf(R):p.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,m=t.inflateSetDictionary(this.strm,z)),m===o.Z_BUF_ERROR&&F===!0&&(m=o.Z_OK,F=!1),m!==o.Z_STREAM_END&&m!==o.Z_OK)return this.onEnd(m),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&m!==o.Z_STREAM_END&&(L.avail_in!==0||x!==o.Z_FINISH&&x!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=i.utf8border(L.output,L.next_out),A=L.next_out-k,C=i.buf2string(L.output,k),L.next_out=A,L.avail_out=W-A,A&&a.arraySet(L.output,L.output,k,A,0),this.onData(C)):this.onData(a.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(F=!0)}while((0<L.avail_in||L.avail_out===0)&&m!==o.Z_STREAM_END);return m===o.Z_STREAM_END&&(x=o.Z_FINISH),x===o.Z_FINISH?(m=t.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===o.Z_OK):x!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(L.avail_out=0))},d.prototype.onData=function(h){this.chunks.push(h)},d.prototype.onEnd=function(h){h===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},s.Inflate=d,s.inflate=y,s.inflateRaw=function(h,v){return(v=v||{}).raw=!0,y(h,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,u,s){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(o){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var b=g.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var f in b)b.hasOwnProperty(f)&&(o[f]=b[f])}}return o},s.shrinkBuf=function(o,g){return o.length===g?o:o.subarray?o.subarray(0,g):(o.length=g,o)};var a={arraySet:function(o,g,b,f,p){if(g.subarray&&o.subarray)o.set(g.subarray(b,b+f),p);else for(var d=0;d<f;d++)o[p+d]=g[b+d]},flattenChunks:function(o){var g,b,f,p,d,y;for(g=f=0,b=o.length;g<b;g++)f+=o[g].length;for(y=new Uint8Array(f),g=p=0,b=o.length;g<b;g++)d=o[g],y.set(d,p),p+=d.length;return y}},i={arraySet:function(o,g,b,f,p){for(var d=0;d<f;d++)o[p+d]=g[b+d]},flattenChunks:function(o){return[].concat.apply([],o)}};s.setTyped=function(o){o?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,i))},s.setTyped(t)},{}],42:[function(r,u,s){var t=r("./common"),a=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{i=!1}for(var o=new t.Buf8(256),g=0;g<256;g++)o[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function b(f,p){if(p<65537&&(f.subarray&&i||!f.subarray&&a))return String.fromCharCode.apply(null,t.shrinkBuf(f,p));for(var d="",y=0;y<p;y++)d+=String.fromCharCode(f[y]);return d}o[254]=o[254]=1,s.string2buf=function(f){var p,d,y,h,v,m=f.length,x=0;for(h=0;h<m;h++)(64512&(d=f.charCodeAt(h)))==55296&&h+1<m&&(64512&(y=f.charCodeAt(h+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),h++),x+=d<128?1:d<2048?2:d<65536?3:4;for(p=new t.Buf8(x),h=v=0;v<x;h++)(64512&(d=f.charCodeAt(h)))==55296&&h+1<m&&(64512&(y=f.charCodeAt(h+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),h++),d<128?p[v++]=d:(d<2048?p[v++]=192|d>>>6:(d<65536?p[v++]=224|d>>>12:(p[v++]=240|d>>>18,p[v++]=128|d>>>12&63),p[v++]=128|d>>>6&63),p[v++]=128|63&d);return p},s.buf2binstring=function(f){return b(f,f.length)},s.binstring2buf=function(f){for(var p=new t.Buf8(f.length),d=0,y=p.length;d<y;d++)p[d]=f.charCodeAt(d);return p},s.buf2string=function(f,p){var d,y,h,v,m=p||f.length,x=new Array(2*m);for(d=y=0;d<m;)if((h=f[d++])<128)x[y++]=h;else if(4<(v=o[h]))x[y++]=65533,d+=v-1;else{for(h&=v===2?31:v===3?15:7;1<v&&d<m;)h=h<<6|63&f[d++],v--;1<v?x[y++]=65533:h<65536?x[y++]=h:(h-=65536,x[y++]=55296|h>>10&1023,x[y++]=56320|1023&h)}return b(x,y)},s.utf8border=function(f,p){var d;for((p=p||f.length)>f.length&&(p=f.length),d=p-1;0<=d&&(192&f[d])==128;)d--;return d<0||d===0?p:d+o[f[d]]>p?d:p}},{"./common":41}],43:[function(r,u,s){u.exports=function(t,a,i,o){for(var g=65535&t|0,b=t>>>16&65535|0,f=0;i!==0;){for(i-=f=2e3<i?2e3:i;b=b+(g=g+a[o++]|0)|0,--f;);g%=65521,b%=65521}return g|b<<16|0}},{}],44:[function(r,u,s){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,u,s){var t=function(){for(var a,i=[],o=0;o<256;o++){a=o;for(var g=0;g<8;g++)a=1&a?3988292384^a>>>1:a>>>1;i[o]=a}return i}();u.exports=function(a,i,o,g){var b=t,f=g+o;a^=-1;for(var p=g;p<f;p++)a=a>>>8^b[255&(a^i[p])];return-1^a}},{}],46:[function(r,u,s){var t,a=r("../utils/common"),i=r("./trees"),o=r("./adler32"),g=r("./crc32"),b=r("./messages"),f=0,p=4,d=0,y=-2,h=-1,v=4,m=2,x=8,k=9,A=286,C=30,z=19,L=2*A+1,W=15,R=3,F=258,K=F+R+1,j=42,B=113,c=1,U=2,ee=3,$=4;function te(n,D){return n.msg=b[D],D}function q(n){return(n<<1)-(4<n?9:0)}function X(n){for(var D=n.length;0<=--D;)n[D]=0}function I(n){var D=n.state,O=D.pending;O>n.avail_out&&(O=n.avail_out),O!==0&&(a.arraySet(n.output,D.pending_buf,D.pending_out,O,n.next_out),n.next_out+=O,D.pending_out+=O,n.total_out+=O,n.avail_out-=O,D.pending-=O,D.pending===0&&(D.pending_out=0))}function T(n,D){i._tr_flush_block(n,0<=n.block_start?n.block_start:-1,n.strstart-n.block_start,D),n.block_start=n.strstart,I(n.strm)}function V(n,D){n.pending_buf[n.pending++]=D}function G(n,D){n.pending_buf[n.pending++]=D>>>8&255,n.pending_buf[n.pending++]=255&D}function H(n,D){var O,w,_=n.max_chain_length,N=n.strstart,P=n.prev_length,M=n.nice_match,E=n.strstart>n.w_size-K?n.strstart-(n.w_size-K):0,Q=n.window,Y=n.w_mask,Z=n.prev,J=n.strstart+F,ae=Q[N+P-1],re=Q[N+P];n.prev_length>=n.good_match&&(_>>=2),M>n.lookahead&&(M=n.lookahead);do if(Q[(O=D)+P]===re&&Q[O+P-1]===ae&&Q[O]===Q[N]&&Q[++O]===Q[N+1]){N+=2,O++;do;while(Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&Q[++N]===Q[++O]&&N<J);if(w=F-(J-N),N=J-F,P<w){if(n.match_start=D,M<=(P=w))break;ae=Q[N+P-1],re=Q[N+P]}}while((D=Z[D&Y])>E&&--_!=0);return P<=n.lookahead?P:n.lookahead}function le(n){var D,O,w,_,N,P,M,E,Q,Y,Z=n.w_size;do{if(_=n.window_size-n.lookahead-n.strstart,n.strstart>=Z+(Z-K)){for(a.arraySet(n.window,n.window,Z,Z,0),n.match_start-=Z,n.strstart-=Z,n.block_start-=Z,D=O=n.hash_size;w=n.head[--D],n.head[D]=Z<=w?w-Z:0,--O;);for(D=O=Z;w=n.prev[--D],n.prev[D]=Z<=w?w-Z:0,--O;);_+=Z}if(n.strm.avail_in===0)break;if(P=n.strm,M=n.window,E=n.strstart+n.lookahead,Q=_,Y=void 0,Y=P.avail_in,Q<Y&&(Y=Q),O=Y===0?0:(P.avail_in-=Y,a.arraySet(M,P.input,P.next_in,Y,E),P.state.wrap===1?P.adler=o(P.adler,M,Y,E):P.state.wrap===2&&(P.adler=g(P.adler,M,Y,E)),P.next_in+=Y,P.total_in+=Y,Y),n.lookahead+=O,n.lookahead+n.insert>=R)for(N=n.strstart-n.insert,n.ins_h=n.window[N],n.ins_h=(n.ins_h<<n.hash_shift^n.window[N+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[N+R-1])&n.hash_mask,n.prev[N&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=N,N++,n.insert--,!(n.lookahead+n.insert<R)););}while(n.lookahead<K&&n.strm.avail_in!==0)}function he(n,D){for(var O,w;;){if(n.lookahead<K){if(le(n),n.lookahead<K&&D===f)return c;if(n.lookahead===0)break}if(O=0,n.lookahead>=R&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+R-1])&n.hash_mask,O=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),O!==0&&n.strstart-O<=n.w_size-K&&(n.match_length=H(n,O)),n.match_length>=R)if(w=i._tr_tally(n,n.strstart-n.match_start,n.match_length-R),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=R){for(n.match_length--;n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+R-1])&n.hash_mask,O=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart,--n.match_length!=0;);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else w=i._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(w&&(T(n,!1),n.strm.avail_out===0))return c}return n.insert=n.strstart<R-1?n.strstart:R-1,D===p?(T(n,!0),n.strm.avail_out===0?ee:$):n.last_lit&&(T(n,!1),n.strm.avail_out===0)?c:U}function se(n,D){for(var O,w,_;;){if(n.lookahead<K){if(le(n),n.lookahead<K&&D===f)return c;if(n.lookahead===0)break}if(O=0,n.lookahead>=R&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+R-1])&n.hash_mask,O=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=R-1,O!==0&&n.prev_length<n.max_lazy_match&&n.strstart-O<=n.w_size-K&&(n.match_length=H(n,O),n.match_length<=5&&(n.strategy===1||n.match_length===R&&4096<n.strstart-n.match_start)&&(n.match_length=R-1)),n.prev_length>=R&&n.match_length<=n.prev_length){for(_=n.strstart+n.lookahead-R,w=i._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-R),n.lookahead-=n.prev_length-1,n.prev_length-=2;++n.strstart<=_&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+R-1])&n.hash_mask,O=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),--n.prev_length!=0;);if(n.match_available=0,n.match_length=R-1,n.strstart++,w&&(T(n,!1),n.strm.avail_out===0))return c}else if(n.match_available){if((w=i._tr_tally(n,0,n.window[n.strstart-1]))&&T(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return c}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(w=i._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<R-1?n.strstart:R-1,D===p?(T(n,!0),n.strm.avail_out===0?ee:$):n.last_lit&&(T(n,!1),n.strm.avail_out===0)?c:U}function ne(n,D,O,w,_){this.good_length=n,this.max_lazy=D,this.nice_length=O,this.max_chain=w,this.func=_}function ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*L),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*z+1)),X(this.dyn_ltree),X(this.dyn_dtree),X(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(W+1),this.heap=new a.Buf16(2*A+1),X(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*A+1),X(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(n){var D;return n&&n.state?(n.total_in=n.total_out=0,n.data_type=m,(D=n.state).pending=0,D.pending_out=0,D.wrap<0&&(D.wrap=-D.wrap),D.status=D.wrap?j:B,n.adler=D.wrap===2?0:1,D.last_flush=f,i._tr_init(D),d):te(n,y)}function me(n){var D=ce(n);return D===d&&function(O){O.window_size=2*O.w_size,X(O.head),O.max_lazy_match=t[O.level].max_lazy,O.good_match=t[O.level].good_length,O.nice_match=t[O.level].nice_length,O.max_chain_length=t[O.level].max_chain,O.strstart=0,O.block_start=0,O.lookahead=0,O.insert=0,O.match_length=O.prev_length=R-1,O.match_available=0,O.ins_h=0}(n.state),D}function fe(n,D,O,w,_,N){if(!n)return y;var P=1;if(D===h&&(D=6),w<0?(P=0,w=-w):15<w&&(P=2,w-=16),_<1||k<_||O!==x||w<8||15<w||D<0||9<D||N<0||v<N)return te(n,y);w===8&&(w=9);var M=new ue;return(n.state=M).strm=n,M.wrap=P,M.gzhead=null,M.w_bits=w,M.w_size=1<<M.w_bits,M.w_mask=M.w_size-1,M.hash_bits=_+7,M.hash_size=1<<M.hash_bits,M.hash_mask=M.hash_size-1,M.hash_shift=~~((M.hash_bits+R-1)/R),M.window=new a.Buf8(2*M.w_size),M.head=new a.Buf16(M.hash_size),M.prev=new a.Buf16(M.w_size),M.lit_bufsize=1<<_+6,M.pending_buf_size=4*M.lit_bufsize,M.pending_buf=new a.Buf8(M.pending_buf_size),M.d_buf=1*M.lit_bufsize,M.l_buf=3*M.lit_bufsize,M.level=D,M.strategy=N,M.method=O,me(n)}t=[new ne(0,0,0,0,function(n,D){var O=65535;for(O>n.pending_buf_size-5&&(O=n.pending_buf_size-5);;){if(n.lookahead<=1){if(le(n),n.lookahead===0&&D===f)return c;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var w=n.block_start+O;if((n.strstart===0||n.strstart>=w)&&(n.lookahead=n.strstart-w,n.strstart=w,T(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-K&&(T(n,!1),n.strm.avail_out===0))return c}return n.insert=0,D===p?(T(n,!0),n.strm.avail_out===0?ee:$):(n.strstart>n.block_start&&(T(n,!1),n.strm.avail_out),c)}),new ne(4,4,8,4,he),new ne(4,5,16,8,he),new ne(4,6,32,32,he),new ne(4,4,16,16,se),new ne(8,16,32,32,se),new ne(8,16,128,128,se),new ne(8,32,128,256,se),new ne(32,128,258,1024,se),new ne(32,258,258,4096,se)],s.deflateInit=function(n,D){return fe(n,D,x,15,8,0)},s.deflateInit2=fe,s.deflateReset=me,s.deflateResetKeep=ce,s.deflateSetHeader=function(n,D){return n&&n.state?n.state.wrap!==2?y:(n.state.gzhead=D,d):y},s.deflate=function(n,D){var O,w,_,N;if(!n||!n.state||5<D||D<0)return n?te(n,y):y;if(w=n.state,!n.output||!n.input&&n.avail_in!==0||w.status===666&&D!==p)return te(n,n.avail_out===0?-5:y);if(w.strm=n,O=w.last_flush,w.last_flush=D,w.status===j)if(w.wrap===2)n.adler=0,V(w,31),V(w,139),V(w,8),w.gzhead?(V(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),V(w,255&w.gzhead.time),V(w,w.gzhead.time>>8&255),V(w,w.gzhead.time>>16&255),V(w,w.gzhead.time>>24&255),V(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),V(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(V(w,255&w.gzhead.extra.length),V(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(n.adler=g(n.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(V(w,0),V(w,0),V(w,0),V(w,0),V(w,0),V(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),V(w,3),w.status=B);else{var P=x+(w.w_bits-8<<4)<<8;P|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(P|=32),P+=31-P%31,w.status=B,G(w,P),w.strstart!==0&&(G(w,n.adler>>>16),G(w,65535&n.adler)),n.adler=1}if(w.status===69)if(w.gzhead.extra){for(_=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>_&&(n.adler=g(n.adler,w.pending_buf,w.pending-_,_)),I(n),_=w.pending,w.pending!==w.pending_buf_size));)V(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>_&&(n.adler=g(n.adler,w.pending_buf,w.pending-_,_)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){_=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>_&&(n.adler=g(n.adler,w.pending_buf,w.pending-_,_)),I(n),_=w.pending,w.pending===w.pending_buf_size)){N=1;break}N=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,V(w,N)}while(N!==0);w.gzhead.hcrc&&w.pending>_&&(n.adler=g(n.adler,w.pending_buf,w.pending-_,_)),N===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){_=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>_&&(n.adler=g(n.adler,w.pending_buf,w.pending-_,_)),I(n),_=w.pending,w.pending===w.pending_buf_size)){N=1;break}N=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,V(w,N)}while(N!==0);w.gzhead.hcrc&&w.pending>_&&(n.adler=g(n.adler,w.pending_buf,w.pending-_,_)),N===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&I(n),w.pending+2<=w.pending_buf_size&&(V(w,255&n.adler),V(w,n.adler>>8&255),n.adler=0,w.status=B)):w.status=B),w.pending!==0){if(I(n),n.avail_out===0)return w.last_flush=-1,d}else if(n.avail_in===0&&q(D)<=q(O)&&D!==p)return te(n,-5);if(w.status===666&&n.avail_in!==0)return te(n,-5);if(n.avail_in!==0||w.lookahead!==0||D!==f&&w.status!==666){var M=w.strategy===2?function(E,Q){for(var Y;;){if(E.lookahead===0&&(le(E),E.lookahead===0)){if(Q===f)return c;break}if(E.match_length=0,Y=i._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++,Y&&(T(E,!1),E.strm.avail_out===0))return c}return E.insert=0,Q===p?(T(E,!0),E.strm.avail_out===0?ee:$):E.last_lit&&(T(E,!1),E.strm.avail_out===0)?c:U}(w,D):w.strategy===3?function(E,Q){for(var Y,Z,J,ae,re=E.window;;){if(E.lookahead<=F){if(le(E),E.lookahead<=F&&Q===f)return c;if(E.lookahead===0)break}if(E.match_length=0,E.lookahead>=R&&0<E.strstart&&(Z=re[J=E.strstart-1])===re[++J]&&Z===re[++J]&&Z===re[++J]){ae=E.strstart+F;do;while(Z===re[++J]&&Z===re[++J]&&Z===re[++J]&&Z===re[++J]&&Z===re[++J]&&Z===re[++J]&&Z===re[++J]&&Z===re[++J]&&J<ae);E.match_length=F-(ae-J),E.match_length>E.lookahead&&(E.match_length=E.lookahead)}if(E.match_length>=R?(Y=i._tr_tally(E,1,E.match_length-R),E.lookahead-=E.match_length,E.strstart+=E.match_length,E.match_length=0):(Y=i._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++),Y&&(T(E,!1),E.strm.avail_out===0))return c}return E.insert=0,Q===p?(T(E,!0),E.strm.avail_out===0?ee:$):E.last_lit&&(T(E,!1),E.strm.avail_out===0)?c:U}(w,D):t[w.level].func(w,D);if(M!==ee&&M!==$||(w.status=666),M===c||M===ee)return n.avail_out===0&&(w.last_flush=-1),d;if(M===U&&(D===1?i._tr_align(w):D!==5&&(i._tr_stored_block(w,0,0,!1),D===3&&(X(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),I(n),n.avail_out===0))return w.last_flush=-1,d}return D!==p?d:w.wrap<=0?1:(w.wrap===2?(V(w,255&n.adler),V(w,n.adler>>8&255),V(w,n.adler>>16&255),V(w,n.adler>>24&255),V(w,255&n.total_in),V(w,n.total_in>>8&255),V(w,n.total_in>>16&255),V(w,n.total_in>>24&255)):(G(w,n.adler>>>16),G(w,65535&n.adler)),I(n),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?d:1)},s.deflateEnd=function(n){var D;return n&&n.state?(D=n.state.status)!==j&&D!==69&&D!==73&&D!==91&&D!==103&&D!==B&&D!==666?te(n,y):(n.state=null,D===B?te(n,-3):d):y},s.deflateSetDictionary=function(n,D){var O,w,_,N,P,M,E,Q,Y=D.length;if(!n||!n.state||(N=(O=n.state).wrap)===2||N===1&&O.status!==j||O.lookahead)return y;for(N===1&&(n.adler=o(n.adler,D,Y,0)),O.wrap=0,Y>=O.w_size&&(N===0&&(X(O.head),O.strstart=0,O.block_start=0,O.insert=0),Q=new a.Buf8(O.w_size),a.arraySet(Q,D,Y-O.w_size,O.w_size,0),D=Q,Y=O.w_size),P=n.avail_in,M=n.next_in,E=n.input,n.avail_in=Y,n.next_in=0,n.input=D,le(O);O.lookahead>=R;){for(w=O.strstart,_=O.lookahead-(R-1);O.ins_h=(O.ins_h<<O.hash_shift^O.window[w+R-1])&O.hash_mask,O.prev[w&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=w,w++,--_;);O.strstart=w,O.lookahead=R-1,le(O)}return O.strstart+=O.lookahead,O.block_start=O.strstart,O.insert=O.lookahead,O.lookahead=0,O.match_length=O.prev_length=R-1,O.match_available=0,n.next_in=M,n.input=E,n.avail_in=P,O.wrap=N,d},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,u,s){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,u,s){u.exports=function(t,a){var i,o,g,b,f,p,d,y,h,v,m,x,k,A,C,z,L,W,R,F,K,j,B,c,U;i=t.state,o=t.next_in,c=t.input,g=o+(t.avail_in-5),b=t.next_out,U=t.output,f=b-(a-t.avail_out),p=b+(t.avail_out-257),d=i.dmax,y=i.wsize,h=i.whave,v=i.wnext,m=i.window,x=i.hold,k=i.bits,A=i.lencode,C=i.distcode,z=(1<<i.lenbits)-1,L=(1<<i.distbits)-1;e:do{k<15&&(x+=c[o++]<<k,k+=8,x+=c[o++]<<k,k+=8),W=A[x&z];t:for(;;){if(x>>>=R=W>>>24,k-=R,(R=W>>>16&255)===0)U[b++]=65535&W;else{if(!(16&R)){if(!(64&R)){W=A[(65535&W)+(x&(1<<R)-1)];continue t}if(32&R){i.mode=12;break e}t.msg="invalid literal/length code",i.mode=30;break e}F=65535&W,(R&=15)&&(k<R&&(x+=c[o++]<<k,k+=8),F+=x&(1<<R)-1,x>>>=R,k-=R),k<15&&(x+=c[o++]<<k,k+=8,x+=c[o++]<<k,k+=8),W=C[x&L];s:for(;;){if(x>>>=R=W>>>24,k-=R,!(16&(R=W>>>16&255))){if(!(64&R)){W=C[(65535&W)+(x&(1<<R)-1)];continue s}t.msg="invalid distance code",i.mode=30;break e}if(K=65535&W,k<(R&=15)&&(x+=c[o++]<<k,(k+=8)<R&&(x+=c[o++]<<k,k+=8)),d<(K+=x&(1<<R)-1)){t.msg="invalid distance too far back",i.mode=30;break e}if(x>>>=R,k-=R,(R=b-f)<K){if(h<(R=K-R)&&i.sane){t.msg="invalid distance too far back",i.mode=30;break e}if(B=m,(j=0)===v){if(j+=y-R,R<F){for(F-=R;U[b++]=m[j++],--R;);j=b-K,B=U}}else if(v<R){if(j+=y+v-R,(R-=v)<F){for(F-=R;U[b++]=m[j++],--R;);if(j=0,v<F){for(F-=R=v;U[b++]=m[j++],--R;);j=b-K,B=U}}}else if(j+=v-R,R<F){for(F-=R;U[b++]=m[j++],--R;);j=b-K,B=U}for(;2<F;)U[b++]=B[j++],U[b++]=B[j++],U[b++]=B[j++],F-=3;F&&(U[b++]=B[j++],1<F&&(U[b++]=B[j++]))}else{for(j=b-K;U[b++]=U[j++],U[b++]=U[j++],U[b++]=U[j++],2<(F-=3););F&&(U[b++]=U[j++],1<F&&(U[b++]=U[j++]))}break}}break}}while(o<g&&b<p);o-=F=k>>3,x&=(1<<(k-=F<<3))-1,t.next_in=o,t.next_out=b,t.avail_in=o<g?g-o+5:5-(o-g),t.avail_out=b<p?p-b+257:257-(b-p),i.hold=x,i.bits=k}},{}],49:[function(r,u,s){var t=r("../utils/common"),a=r("./adler32"),i=r("./crc32"),o=r("./inffast"),g=r("./inftrees"),b=1,f=2,p=0,d=-2,y=1,h=852,v=592;function m(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new t.Buf16(320),this.work=new t.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(j){var B;return j&&j.state?(B=j.state,j.total_in=j.total_out=B.total=0,j.msg="",B.wrap&&(j.adler=1&B.wrap),B.mode=y,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new t.Buf32(h),B.distcode=B.distdyn=new t.Buf32(v),B.sane=1,B.back=-1,p):d}function A(j){var B;return j&&j.state?((B=j.state).wsize=0,B.whave=0,B.wnext=0,k(j)):d}function C(j,B){var c,U;return j&&j.state?(U=j.state,B<0?(c=0,B=-B):(c=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?d:(U.window!==null&&U.wbits!==B&&(U.window=null),U.wrap=c,U.wbits=B,A(j))):d}function z(j,B){var c,U;return j?(U=new x,(j.state=U).window=null,(c=C(j,B))!==p&&(j.state=null),c):d}var L,W,R=!0;function F(j){if(R){var B;for(L=new t.Buf32(512),W=new t.Buf32(32),B=0;B<144;)j.lens[B++]=8;for(;B<256;)j.lens[B++]=9;for(;B<280;)j.lens[B++]=7;for(;B<288;)j.lens[B++]=8;for(g(b,j.lens,0,288,L,0,j.work,{bits:9}),B=0;B<32;)j.lens[B++]=5;g(f,j.lens,0,32,W,0,j.work,{bits:5}),R=!1}j.lencode=L,j.lenbits=9,j.distcode=W,j.distbits=5}function K(j,B,c,U){var ee,$=j.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new t.Buf8($.wsize)),U>=$.wsize?(t.arraySet($.window,B,c-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(U<(ee=$.wsize-$.wnext)&&(ee=U),t.arraySet($.window,B,c-U,ee,$.wnext),(U-=ee)?(t.arraySet($.window,B,c-U,U,0),$.wnext=U,$.whave=$.wsize):($.wnext+=ee,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=ee))),0}s.inflateReset=A,s.inflateReset2=C,s.inflateResetKeep=k,s.inflateInit=function(j){return z(j,15)},s.inflateInit2=z,s.inflate=function(j,B){var c,U,ee,$,te,q,X,I,T,V,G,H,le,he,se,ne,ue,ce,me,fe,n,D,O,w,_=0,N=new t.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return d;(c=j.state).mode===12&&(c.mode=13),te=j.next_out,ee=j.output,X=j.avail_out,$=j.next_in,U=j.input,q=j.avail_in,I=c.hold,T=c.bits,V=q,G=X,D=p;e:for(;;)switch(c.mode){case y:if(c.wrap===0){c.mode=13;break}for(;T<16;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(2&c.wrap&&I===35615){N[c.check=0]=255&I,N[1]=I>>>8&255,c.check=i(c.check,N,2,0),T=I=0,c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&I)<<8)+(I>>8))%31){j.msg="incorrect header check",c.mode=30;break}if((15&I)!=8){j.msg="unknown compression method",c.mode=30;break}if(T-=4,n=8+(15&(I>>>=4)),c.wbits===0)c.wbits=n;else if(n>c.wbits){j.msg="invalid window size",c.mode=30;break}c.dmax=1<<n,j.adler=c.check=1,c.mode=512&I?10:12,T=I=0;break;case 2:for(;T<16;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(c.flags=I,(255&c.flags)!=8){j.msg="unknown compression method",c.mode=30;break}if(57344&c.flags){j.msg="unknown header flags set",c.mode=30;break}c.head&&(c.head.text=I>>8&1),512&c.flags&&(N[0]=255&I,N[1]=I>>>8&255,c.check=i(c.check,N,2,0)),T=I=0,c.mode=3;case 3:for(;T<32;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}c.head&&(c.head.time=I),512&c.flags&&(N[0]=255&I,N[1]=I>>>8&255,N[2]=I>>>16&255,N[3]=I>>>24&255,c.check=i(c.check,N,4,0)),T=I=0,c.mode=4;case 4:for(;T<16;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}c.head&&(c.head.xflags=255&I,c.head.os=I>>8),512&c.flags&&(N[0]=255&I,N[1]=I>>>8&255,c.check=i(c.check,N,2,0)),T=I=0,c.mode=5;case 5:if(1024&c.flags){for(;T<16;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}c.length=I,c.head&&(c.head.extra_len=I),512&c.flags&&(N[0]=255&I,N[1]=I>>>8&255,c.check=i(c.check,N,2,0)),T=I=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&(q<(H=c.length)&&(H=q),H&&(c.head&&(n=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),t.arraySet(c.head.extra,U,$,H,n)),512&c.flags&&(c.check=i(c.check,U,H,$)),q-=H,$+=H,c.length-=H),c.length))break e;c.length=0,c.mode=7;case 7:if(2048&c.flags){if(q===0)break e;for(H=0;n=U[$+H++],c.head&&n&&c.length<65536&&(c.head.name+=String.fromCharCode(n)),n&&H<q;);if(512&c.flags&&(c.check=i(c.check,U,H,$)),q-=H,$+=H,n)break e}else c.head&&(c.head.name=null);c.length=0,c.mode=8;case 8:if(4096&c.flags){if(q===0)break e;for(H=0;n=U[$+H++],c.head&&n&&c.length<65536&&(c.head.comment+=String.fromCharCode(n)),n&&H<q;);if(512&c.flags&&(c.check=i(c.check,U,H,$)),q-=H,$+=H,n)break e}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;T<16;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(I!==(65535&c.check)){j.msg="header crc mismatch",c.mode=30;break}T=I=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),j.adler=c.check=0,c.mode=12;break;case 10:for(;T<32;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}j.adler=c.check=m(I),T=I=0,c.mode=11;case 11:if(c.havedict===0)return j.next_out=te,j.avail_out=X,j.next_in=$,j.avail_in=q,c.hold=I,c.bits=T,2;j.adler=c.check=1,c.mode=12;case 12:if(B===5||B===6)break e;case 13:if(c.last){I>>>=7&T,T-=7&T,c.mode=27;break}for(;T<3;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}switch(c.last=1&I,T-=1,3&(I>>>=1)){case 0:c.mode=14;break;case 1:if(F(c),c.mode=20,B!==6)break;I>>>=2,T-=2;break e;case 2:c.mode=17;break;case 3:j.msg="invalid block type",c.mode=30}I>>>=2,T-=2;break;case 14:for(I>>>=7&T,T-=7&T;T<32;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if((65535&I)!=(I>>>16^65535)){j.msg="invalid stored block lengths",c.mode=30;break}if(c.length=65535&I,T=I=0,c.mode=15,B===6)break e;case 15:c.mode=16;case 16:if(H=c.length){if(q<H&&(H=q),X<H&&(H=X),H===0)break e;t.arraySet(ee,U,$,H,te),q-=H,$+=H,X-=H,te+=H,c.length-=H;break}c.mode=12;break;case 17:for(;T<14;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(c.nlen=257+(31&I),I>>>=5,T-=5,c.ndist=1+(31&I),I>>>=5,T-=5,c.ncode=4+(15&I),I>>>=4,T-=4,286<c.nlen||30<c.ndist){j.msg="too many length or distance symbols",c.mode=30;break}c.have=0,c.mode=18;case 18:for(;c.have<c.ncode;){for(;T<3;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}c.lens[P[c.have++]]=7&I,I>>>=3,T-=3}for(;c.have<19;)c.lens[P[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,O={bits:c.lenbits},D=g(0,c.lens,0,19,c.lencode,0,c.work,O),c.lenbits=O.bits,D){j.msg="invalid code lengths set",c.mode=30;break}c.have=0,c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;ne=(_=c.lencode[I&(1<<c.lenbits)-1])>>>16&255,ue=65535&_,!((se=_>>>24)<=T);){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(ue<16)I>>>=se,T-=se,c.lens[c.have++]=ue;else{if(ue===16){for(w=se+2;T<w;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(I>>>=se,T-=se,c.have===0){j.msg="invalid bit length repeat",c.mode=30;break}n=c.lens[c.have-1],H=3+(3&I),I>>>=2,T-=2}else if(ue===17){for(w=se+3;T<w;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}T-=se,n=0,H=3+(7&(I>>>=se)),I>>>=3,T-=3}else{for(w=se+7;T<w;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}T-=se,n=0,H=11+(127&(I>>>=se)),I>>>=7,T-=7}if(c.have+H>c.nlen+c.ndist){j.msg="invalid bit length repeat",c.mode=30;break}for(;H--;)c.lens[c.have++]=n}}if(c.mode===30)break;if(c.lens[256]===0){j.msg="invalid code -- missing end-of-block",c.mode=30;break}if(c.lenbits=9,O={bits:c.lenbits},D=g(b,c.lens,0,c.nlen,c.lencode,0,c.work,O),c.lenbits=O.bits,D){j.msg="invalid literal/lengths set",c.mode=30;break}if(c.distbits=6,c.distcode=c.distdyn,O={bits:c.distbits},D=g(f,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,O),c.distbits=O.bits,D){j.msg="invalid distances set",c.mode=30;break}if(c.mode=20,B===6)break e;case 20:c.mode=21;case 21:if(6<=q&&258<=X){j.next_out=te,j.avail_out=X,j.next_in=$,j.avail_in=q,c.hold=I,c.bits=T,o(j,G),te=j.next_out,ee=j.output,X=j.avail_out,$=j.next_in,U=j.input,q=j.avail_in,I=c.hold,T=c.bits,c.mode===12&&(c.back=-1);break}for(c.back=0;ne=(_=c.lencode[I&(1<<c.lenbits)-1])>>>16&255,ue=65535&_,!((se=_>>>24)<=T);){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(ne&&!(240&ne)){for(ce=se,me=ne,fe=ue;ne=(_=c.lencode[fe+((I&(1<<ce+me)-1)>>ce)])>>>16&255,ue=65535&_,!(ce+(se=_>>>24)<=T);){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}I>>>=ce,T-=ce,c.back+=ce}if(I>>>=se,T-=se,c.back+=se,c.length=ue,ne===0){c.mode=26;break}if(32&ne){c.back=-1,c.mode=12;break}if(64&ne){j.msg="invalid literal/length code",c.mode=30;break}c.extra=15&ne,c.mode=22;case 22:if(c.extra){for(w=c.extra;T<w;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}c.length+=I&(1<<c.extra)-1,I>>>=c.extra,T-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=23;case 23:for(;ne=(_=c.distcode[I&(1<<c.distbits)-1])>>>16&255,ue=65535&_,!((se=_>>>24)<=T);){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(!(240&ne)){for(ce=se,me=ne,fe=ue;ne=(_=c.distcode[fe+((I&(1<<ce+me)-1)>>ce)])>>>16&255,ue=65535&_,!(ce+(se=_>>>24)<=T);){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}I>>>=ce,T-=ce,c.back+=ce}if(I>>>=se,T-=se,c.back+=se,64&ne){j.msg="invalid distance code",c.mode=30;break}c.offset=ue,c.extra=15&ne,c.mode=24;case 24:if(c.extra){for(w=c.extra;T<w;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}c.offset+=I&(1<<c.extra)-1,I>>>=c.extra,T-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){j.msg="invalid distance too far back",c.mode=30;break}c.mode=25;case 25:if(X===0)break e;if(H=G-X,c.offset>H){if((H=c.offset-H)>c.whave&&c.sane){j.msg="invalid distance too far back",c.mode=30;break}le=H>c.wnext?(H-=c.wnext,c.wsize-H):c.wnext-H,H>c.length&&(H=c.length),he=c.window}else he=ee,le=te-c.offset,H=c.length;for(X<H&&(H=X),X-=H,c.length-=H;ee[te++]=he[le++],--H;);c.length===0&&(c.mode=21);break;case 26:if(X===0)break e;ee[te++]=c.length,X--,c.mode=21;break;case 27:if(c.wrap){for(;T<32;){if(q===0)break e;q--,I|=U[$++]<<T,T+=8}if(G-=X,j.total_out+=G,c.total+=G,G&&(j.adler=c.check=c.flags?i(c.check,ee,G,te-G):a(c.check,ee,G,te-G)),G=X,(c.flags?I:m(I))!==c.check){j.msg="incorrect data check",c.mode=30;break}T=I=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;T<32;){if(q===0)break e;q--,I+=U[$++]<<T,T+=8}if(I!==(4294967295&c.total)){j.msg="incorrect length check",c.mode=30;break}T=I=0}c.mode=29;case 29:D=1;break e;case 30:D=-3;break e;case 31:return-4;case 32:default:return d}return j.next_out=te,j.avail_out=X,j.next_in=$,j.avail_in=q,c.hold=I,c.bits=T,(c.wsize||G!==j.avail_out&&c.mode<30&&(c.mode<27||B!==4))&&K(j,j.output,j.next_out,G-j.avail_out)?(c.mode=31,-4):(V-=j.avail_in,G-=j.avail_out,j.total_in+=V,j.total_out+=G,c.total+=G,c.wrap&&G&&(j.adler=c.check=c.flags?i(c.check,ee,G,j.next_out-G):a(c.check,ee,G,j.next_out-G)),j.data_type=c.bits+(c.last?64:0)+(c.mode===12?128:0)+(c.mode===20||c.mode===15?256:0),(V==0&&G===0||B===4)&&D===p&&(D=-5),D)},s.inflateEnd=function(j){if(!j||!j.state)return d;var B=j.state;return B.window&&(B.window=null),j.state=null,p},s.inflateGetHeader=function(j,B){var c;return j&&j.state&&2&(c=j.state).wrap?((c.head=B).done=!1,p):d},s.inflateSetDictionary=function(j,B){var c,U=B.length;return j&&j.state?(c=j.state).wrap!==0&&c.mode!==11?d:c.mode===11&&a(1,B,U,0)!==c.check?-3:K(j,B,U,U)?(c.mode=31,-4):(c.havedict=1,p):d},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,u,s){var t=r("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(b,f,p,d,y,h,v,m){var x,k,A,C,z,L,W,R,F,K=m.bits,j=0,B=0,c=0,U=0,ee=0,$=0,te=0,q=0,X=0,I=0,T=null,V=0,G=new t.Buf16(16),H=new t.Buf16(16),le=null,he=0;for(j=0;j<=15;j++)G[j]=0;for(B=0;B<d;B++)G[f[p+B]]++;for(ee=K,U=15;1<=U&&G[U]===0;U--);if(U<ee&&(ee=U),U===0)return y[h++]=20971520,y[h++]=20971520,m.bits=1,0;for(c=1;c<U&&G[c]===0;c++);for(ee<c&&(ee=c),j=q=1;j<=15;j++)if(q<<=1,(q-=G[j])<0)return-1;if(0<q&&(b===0||U!==1))return-1;for(H[1]=0,j=1;j<15;j++)H[j+1]=H[j]+G[j];for(B=0;B<d;B++)f[p+B]!==0&&(v[H[f[p+B]]++]=B);if(L=b===0?(T=le=v,19):b===1?(T=a,V-=257,le=i,he-=257,256):(T=o,le=g,-1),j=c,z=h,te=B=I=0,A=-1,C=(X=1<<($=ee))-1,b===1&&852<X||b===2&&592<X)return 1;for(;;){for(W=j-te,F=v[B]<L?(R=0,v[B]):v[B]>L?(R=le[he+v[B]],T[V+v[B]]):(R=96,0),x=1<<j-te,c=k=1<<$;y[z+(I>>te)+(k-=x)]=W<<24|R<<16|F|0,k!==0;);for(x=1<<j-1;I&x;)x>>=1;if(x!==0?(I&=x-1,I+=x):I=0,B++,--G[j]==0){if(j===U)break;j=f[p+v[B]]}if(ee<j&&(I&C)!==A){for(te===0&&(te=ee),z+=c,q=1<<($=j-te);$+te<U&&!((q-=G[$+te])<=0);)$++,q<<=1;if(X+=1<<$,b===1&&852<X||b===2&&592<X)return 1;y[A=I&C]=ee<<24|$<<16|z-h|0}}return I!==0&&(y[z+I]=j-te<<24|64<<16|0),m.bits=ee,0}},{"../utils/common":41}],51:[function(r,u,s){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,u,s){var t=r("../utils/common"),a=0,i=1;function o(_){for(var N=_.length;0<=--N;)_[N]=0}var g=0,b=29,f=256,p=f+1+b,d=30,y=19,h=2*p+1,v=15,m=16,x=7,k=256,A=16,C=17,z=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(p+2));o(K);var j=new Array(2*d);o(j);var B=new Array(512);o(B);var c=new Array(256);o(c);var U=new Array(b);o(U);var ee,$,te,q=new Array(d);function X(_,N,P,M,E){this.static_tree=_,this.extra_bits=N,this.extra_base=P,this.elems=M,this.max_length=E,this.has_stree=_&&_.length}function I(_,N){this.dyn_tree=_,this.max_code=0,this.stat_desc=N}function T(_){return _<256?B[_]:B[256+(_>>>7)]}function V(_,N){_.pending_buf[_.pending++]=255&N,_.pending_buf[_.pending++]=N>>>8&255}function G(_,N,P){_.bi_valid>m-P?(_.bi_buf|=N<<_.bi_valid&65535,V(_,_.bi_buf),_.bi_buf=N>>m-_.bi_valid,_.bi_valid+=P-m):(_.bi_buf|=N<<_.bi_valid&65535,_.bi_valid+=P)}function H(_,N,P){G(_,P[2*N],P[2*N+1])}function le(_,N){for(var P=0;P|=1&_,_>>>=1,P<<=1,0<--N;);return P>>>1}function he(_,N,P){var M,E,Q=new Array(v+1),Y=0;for(M=1;M<=v;M++)Q[M]=Y=Y+P[M-1]<<1;for(E=0;E<=N;E++){var Z=_[2*E+1];Z!==0&&(_[2*E]=le(Q[Z]++,Z))}}function se(_){var N;for(N=0;N<p;N++)_.dyn_ltree[2*N]=0;for(N=0;N<d;N++)_.dyn_dtree[2*N]=0;for(N=0;N<y;N++)_.bl_tree[2*N]=0;_.dyn_ltree[2*k]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0}function ne(_){8<_.bi_valid?V(_,_.bi_buf):0<_.bi_valid&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0}function ue(_,N,P,M){var E=2*N,Q=2*P;return _[E]<_[Q]||_[E]===_[Q]&&M[N]<=M[P]}function ce(_,N,P){for(var M=_.heap[P],E=P<<1;E<=_.heap_len&&(E<_.heap_len&&ue(N,_.heap[E+1],_.heap[E],_.depth)&&E++,!ue(N,M,_.heap[E],_.depth));)_.heap[P]=_.heap[E],P=E,E<<=1;_.heap[P]=M}function me(_,N,P){var M,E,Q,Y,Z=0;if(_.last_lit!==0)for(;M=_.pending_buf[_.d_buf+2*Z]<<8|_.pending_buf[_.d_buf+2*Z+1],E=_.pending_buf[_.l_buf+Z],Z++,M===0?H(_,E,N):(H(_,(Q=c[E])+f+1,N),(Y=L[Q])!==0&&G(_,E-=U[Q],Y),H(_,Q=T(--M),P),(Y=W[Q])!==0&&G(_,M-=q[Q],Y)),Z<_.last_lit;);H(_,k,N)}function fe(_,N){var P,M,E,Q=N.dyn_tree,Y=N.stat_desc.static_tree,Z=N.stat_desc.has_stree,J=N.stat_desc.elems,ae=-1;for(_.heap_len=0,_.heap_max=h,P=0;P<J;P++)Q[2*P]!==0?(_.heap[++_.heap_len]=ae=P,_.depth[P]=0):Q[2*P+1]=0;for(;_.heap_len<2;)Q[2*(E=_.heap[++_.heap_len]=ae<2?++ae:0)]=1,_.depth[E]=0,_.opt_len--,Z&&(_.static_len-=Y[2*E+1]);for(N.max_code=ae,P=_.heap_len>>1;1<=P;P--)ce(_,Q,P);for(E=J;P=_.heap[1],_.heap[1]=_.heap[_.heap_len--],ce(_,Q,1),M=_.heap[1],_.heap[--_.heap_max]=P,_.heap[--_.heap_max]=M,Q[2*E]=Q[2*P]+Q[2*M],_.depth[E]=(_.depth[P]>=_.depth[M]?_.depth[P]:_.depth[M])+1,Q[2*P+1]=Q[2*M+1]=E,_.heap[1]=E++,ce(_,Q,1),2<=_.heap_len;);_.heap[--_.heap_max]=_.heap[1],function(re,pe){var we,ge,Se,de,je,Te,ve=pe.dyn_tree,Oe=pe.max_code,Ge=pe.stat_desc.static_tree,Ye=pe.stat_desc.has_stree,Ke=pe.stat_desc.extra_bits,Le=pe.stat_desc.extra_base,ke=pe.stat_desc.max_length,Ne=0;for(de=0;de<=v;de++)re.bl_count[de]=0;for(ve[2*re.heap[re.heap_max]+1]=0,we=re.heap_max+1;we<h;we++)ke<(de=ve[2*ve[2*(ge=re.heap[we])+1]+1]+1)&&(de=ke,Ne++),ve[2*ge+1]=de,Oe<ge||(re.bl_count[de]++,je=0,Le<=ge&&(je=Ke[ge-Le]),Te=ve[2*ge],re.opt_len+=Te*(de+je),Ye&&(re.static_len+=Te*(Ge[2*ge+1]+je)));if(Ne!==0){do{for(de=ke-1;re.bl_count[de]===0;)de--;re.bl_count[de]--,re.bl_count[de+1]+=2,re.bl_count[ke]--,Ne-=2}while(0<Ne);for(de=ke;de!==0;de--)for(ge=re.bl_count[de];ge!==0;)Oe<(Se=re.heap[--we])||(ve[2*Se+1]!==de&&(re.opt_len+=(de-ve[2*Se+1])*ve[2*Se],ve[2*Se+1]=de),ge--)}}(_,N),he(Q,ae,_.bl_count)}function n(_,N,P){var M,E,Q=-1,Y=N[1],Z=0,J=7,ae=4;for(Y===0&&(J=138,ae=3),N[2*(P+1)+1]=65535,M=0;M<=P;M++)E=Y,Y=N[2*(M+1)+1],++Z<J&&E===Y||(Z<ae?_.bl_tree[2*E]+=Z:E!==0?(E!==Q&&_.bl_tree[2*E]++,_.bl_tree[2*A]++):Z<=10?_.bl_tree[2*C]++:_.bl_tree[2*z]++,Q=E,ae=(Z=0)===Y?(J=138,3):E===Y?(J=6,3):(J=7,4))}function D(_,N,P){var M,E,Q=-1,Y=N[1],Z=0,J=7,ae=4;for(Y===0&&(J=138,ae=3),M=0;M<=P;M++)if(E=Y,Y=N[2*(M+1)+1],!(++Z<J&&E===Y)){if(Z<ae)for(;H(_,E,_.bl_tree),--Z!=0;);else E!==0?(E!==Q&&(H(_,E,_.bl_tree),Z--),H(_,A,_.bl_tree),G(_,Z-3,2)):Z<=10?(H(_,C,_.bl_tree),G(_,Z-3,3)):(H(_,z,_.bl_tree),G(_,Z-11,7));Q=E,ae=(Z=0)===Y?(J=138,3):E===Y?(J=6,3):(J=7,4)}}o(q);var O=!1;function w(_,N,P,M){G(_,(g<<1)+(M?1:0),3),function(E,Q,Y,Z){ne(E),V(E,Y),V(E,~Y),t.arraySet(E.pending_buf,E.window,Q,Y,E.pending),E.pending+=Y}(_,N,P)}s._tr_init=function(_){O||(function(){var N,P,M,E,Q,Y=new Array(v+1);for(E=M=0;E<b-1;E++)for(U[E]=M,N=0;N<1<<L[E];N++)c[M++]=E;for(c[M-1]=E,E=Q=0;E<16;E++)for(q[E]=Q,N=0;N<1<<W[E];N++)B[Q++]=E;for(Q>>=7;E<d;E++)for(q[E]=Q<<7,N=0;N<1<<W[E]-7;N++)B[256+Q++]=E;for(P=0;P<=v;P++)Y[P]=0;for(N=0;N<=143;)K[2*N+1]=8,N++,Y[8]++;for(;N<=255;)K[2*N+1]=9,N++,Y[9]++;for(;N<=279;)K[2*N+1]=7,N++,Y[7]++;for(;N<=287;)K[2*N+1]=8,N++,Y[8]++;for(he(K,p+1,Y),N=0;N<d;N++)j[2*N+1]=5,j[2*N]=le(N,5);ee=new X(K,L,f+1,p,v),$=new X(j,W,0,d,v),te=new X(new Array(0),R,0,y,x)}(),O=!0),_.l_desc=new I(_.dyn_ltree,ee),_.d_desc=new I(_.dyn_dtree,$),_.bl_desc=new I(_.bl_tree,te),_.bi_buf=0,_.bi_valid=0,se(_)},s._tr_stored_block=w,s._tr_flush_block=function(_,N,P,M){var E,Q,Y=0;0<_.level?(_.strm.data_type===2&&(_.strm.data_type=function(Z){var J,ae=4093624447;for(J=0;J<=31;J++,ae>>>=1)if(1&ae&&Z.dyn_ltree[2*J]!==0)return a;if(Z.dyn_ltree[18]!==0||Z.dyn_ltree[20]!==0||Z.dyn_ltree[26]!==0)return i;for(J=32;J<f;J++)if(Z.dyn_ltree[2*J]!==0)return i;return a}(_)),fe(_,_.l_desc),fe(_,_.d_desc),Y=function(Z){var J;for(n(Z,Z.dyn_ltree,Z.l_desc.max_code),n(Z,Z.dyn_dtree,Z.d_desc.max_code),fe(Z,Z.bl_desc),J=y-1;3<=J&&Z.bl_tree[2*F[J]+1]===0;J--);return Z.opt_len+=3*(J+1)+5+5+4,J}(_),E=_.opt_len+3+7>>>3,(Q=_.static_len+3+7>>>3)<=E&&(E=Q)):E=Q=P+5,P+4<=E&&N!==-1?w(_,N,P,M):_.strategy===4||Q===E?(G(_,2+(M?1:0),3),me(_,K,j)):(G(_,4+(M?1:0),3),function(Z,J,ae,re){var pe;for(G(Z,J-257,5),G(Z,ae-1,5),G(Z,re-4,4),pe=0;pe<re;pe++)G(Z,Z.bl_tree[2*F[pe]+1],3);D(Z,Z.dyn_ltree,J-1),D(Z,Z.dyn_dtree,ae-1)}(_,_.l_desc.max_code+1,_.d_desc.max_code+1,Y+1),me(_,_.dyn_ltree,_.dyn_dtree)),se(_),M&&ne(_)},s._tr_tally=function(_,N,P){return _.pending_buf[_.d_buf+2*_.last_lit]=N>>>8&255,_.pending_buf[_.d_buf+2*_.last_lit+1]=255&N,_.pending_buf[_.l_buf+_.last_lit]=255&P,_.last_lit++,N===0?_.dyn_ltree[2*P]++:(_.matches++,N--,_.dyn_ltree[2*(c[P]+f+1)]++,_.dyn_dtree[2*T(N)]++),_.last_lit===_.lit_bufsize-1},s._tr_align=function(_){G(_,2,3),H(_,k,K),function(N){N.bi_valid===16?(V(N,N.bi_buf),N.bi_buf=0,N.bi_valid=0):8<=N.bi_valid&&(N.pending_buf[N.pending++]=255&N.bi_buf,N.bi_buf>>=8,N.bi_valid-=8)}(_)}},{"../utils/common":41}],53:[function(r,u,s){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,u,s){(function(t){(function(a,i){if(!a.setImmediate){var o,g,b,f,p=1,d={},y=!1,h=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,o={}.toString.call(a.process)==="[object process]"?function(A){process.nextTick(function(){x(A)})}:function(){if(a.postMessage&&!a.importScripts){var A=!0,C=a.onmessage;return a.onmessage=function(){A=!1},a.postMessage("","*"),a.onmessage=C,A}}()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",k,!1):a.attachEvent("onmessage",k),function(A){a.postMessage(f+A,"*")}):a.MessageChannel?((b=new MessageChannel).port1.onmessage=function(A){x(A.data)},function(A){b.port2.postMessage(A)}):h&&"onreadystatechange"in h.createElement("script")?(g=h.documentElement,function(A){var C=h.createElement("script");C.onreadystatechange=function(){x(A),C.onreadystatechange=null,g.removeChild(C),C=null},g.appendChild(C)}):function(A){setTimeout(x,0,A)},v.setImmediate=function(A){typeof A!="function"&&(A=new Function(""+A));for(var C=new Array(arguments.length-1),z=0;z<C.length;z++)C[z]=arguments[z+1];var L={callback:A,args:C};return d[p]=L,o(p),p++},v.clearImmediate=m}function m(A){delete d[A]}function x(A){if(y)setTimeout(x,0,A);else{var C=d[A];if(C){y=!0;try{(function(z){var L=z.callback,W=z.args;switch(W.length){case 0:L();break;case 1:L(W[0]);break;case 2:L(W[0],W[1]);break;case 3:L(W[0],W[1],W[2]);break;default:L.apply(i,W)}})(C)}finally{m(A),y=!1}}}}function k(A){A.source===a&&typeof A.data=="string"&&A.data.indexOf(f)===0&&x(+A.data.slice(f.length))}})(typeof self>"u"?t===void 0?this:t:self)}).call(this,typeof Ae<"u"?Ae:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Qe);var ht=Qe.exports;const pt=Ve(ht);function ft(S){if(S===0)return"0 Bytes";const l=1024,r=["Bytes","KB","MB","GB"],u=Math.floor(Math.log(S)/Math.log(l));return parseFloat((S/Math.pow(l,u)).toFixed(2))+" "+r[u]}function mt(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function gt(S){try{return new URL(S),!0}catch{return!1}}function yt(S){return new Promise(l=>setTimeout(l,S))}function vt(S,l,r="application/json"){const u=new Blob([S],{type:r}),s=URL.createObjectURL(u),t=document.createElement("a");t.href=s,t.download=l,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)}function Ze(S,l){try{const r=JSON.parse(S);return Array.isArray(r)?r.map((u,s)=>({id:u.session_id||u.id||`${l}-${s}`,messages:u.messages||[u],metadata:{timestamp:u.timestamp,language:u.language,escalated:u.escalation_flag,hasOrder:u.order_flag}})):[{id:r.session_id||r.id||l,messages:r.messages||[r],metadata:{timestamp:r.timestamp,language:r.language,escalated:r.escalation_flag,hasOrder:r.order_flag}}]}catch{return xt(S,l)}}function xt(S,l){return/\[(\d{4}-\d{2}-\d{2}T[\d:.]+\+[\d:]+)\]\s*(USER|AI|RESULTS|CONVERSATION STARTED)(?:\s*:\s*)?/i.test(S)?bt(S,l):wt(S,l)}function bt(S,l){const r=S.split(`
`),u=[];let s=null,t=l,a=null,i=null;const o=l.match(/session_([a-f0-9-]+)_transcript/i);o&&(t=o[1]);const g=/^\[(\d{4}-\d{2}-\d{2}T[\d:.]+(?:\+[\d:]+)?)\]\s*(USER|AI|RESULTS|CONVERSATION STARTED)(?:\s*:\s*)?(.*)$/i,b=/^={10,}$/;for(const f of r){const p=f.trim();if(b.test(p)||!p)continue;const d=p.match(g);if(p.includes("RESULTS")&&!d&&console.warn("‚ö†Ô∏è RESULTS line not matching regex:",p.substring(0,150)),d){s&&u.push(s);const[,y,h,v]=d,m=new Date(y);(!a||m<a)&&(a=m),(!i||m>i)&&(i=m);const x=h.toUpperCase();if(x==="CONVERSATION STARTED"){s=null;continue}if(x==="RESULTS"){if(console.log("üì¶ RESULTS line detected:",v.substring(0,100)+"..."),u.length>0){const k=u[u.length-1];console.log("  Last message role:",k.role),k.role==="bot"&&(k.results=_t(v),console.log("  ‚úÖ Results attached:",k.results))}s=null;continue}s={role:x==="USER"?"user":"bot",content:v.trim(),timestamp:y}}else s&&p&&(s.content+=" "+p)}return s&&u.push(s),[{id:t,messages:u,metadata:{timestamp:(a==null?void 0:a.toISOString())||null,dateRange:{start:(a==null?void 0:a.toISOString())||null,end:(i==null?void 0:i.toISOString())||null},sourceFile:l,format:"timestamped"}}]}function _t(S){const l={},r=S.match(/STYLES:\s*\[([^\]]+)\]/i);r&&(l.styles=r[1].split(",").map(s=>s.trim().replace(/['"]/g,"")));const u=S.match(/PRODUCTS\s*(\[[\s\S]*\])/i);if(u)try{l.products=JSON.parse(u[1].replace(/'/g,'"'))}catch{l.productsRaw=u[1]}return l}function wt(S,l){const r=S.split(`
`).filter(t=>t.trim()),u=[];let s={id:l,messages:[],metadata:{}};for(const t of r){const a=t.match(/^(user|customer|human|visitor)\s*[:\-]\s*(.+)/i),i=t.match(/^(bot|assistant|agent|chatbot|ai)\s*[:\-]\s*(.+)/i),o=t.match(/^(session|conversation)\s*[:\-]\s*(.+)/i);if(o)s.messages.length>0&&u.push(s),s={id:o[2].trim(),messages:[],metadata:{}};else if(a)s.messages.push({role:"user",content:a[2].trim()});else if(i)s.messages.push({role:"bot",content:i[2].trim()});else if(t.trim()&&s.messages.length>0){const g=s.messages[s.messages.length-1];g.content+=" "+t.trim()}}return s.messages.length>0&&u.push(s),u.length>0?u:[{id:l,messages:[{role:"unknown",content:S}],metadata:{}}]}function St(S){return S?Math.ceil(S.length/4):0}async function kt(S){const l=[];for(const r of S)try{if(r.name.endsWith(".zip")){const u=await Nt(r);l.push(...u)}else{const u=await jt(r),s=Ze(u,r.name);l.push({filename:r.name,transcripts:s,error:null})}}catch(u){l.push({filename:r.name,transcripts:[],error:u.message})}return l}async function jt(S){return new Promise((l,r)=>{const u=new FileReader;u.onload=s=>l(s.target.result),u.onerror=s=>r(new Error("Failed to read file")),u.readAsText(S)})}async function Nt(S){const r=await new pt().loadAsync(S),u=[],s=Object.entries(r.files).filter(([t,a])=>!a.dir&&(t.endsWith(".txt")||t.endsWith(".json")));for(const[t,a]of s)try{const i=await a.async("string"),o=Ze(i,t);u.push({filename:t,transcripts:o,error:null})}catch(i){u.push({filename:t,transcripts:[],error:i.message})}return u}function At(S){var r;const l=[];for(const u of S)if(!u.error)for(const s of u.transcripts){const t={id:s.id||mt(),sourceFile:u.filename,messages:Ct(s.messages||[]),metadata:{...s.metadata,messageCount:((r=s.messages)==null?void 0:r.length)||0,hasEscalation:Et(s.messages||[]),hasOrder:Tt(s.messages||[]),userTurns:Rt(s.messages||[]),botTurns:It(s.messages||[])}};l.push(t)}return l}function Ct(S){return S.map((l,r)=>({id:l.id||`msg-${r}`,role:ze(l.role||l.sender||"unknown"),content:l.content||l.text||l.message||"",timestamp:l.timestamp||null}))}function ze(S){const l=["user","customer","human","visitor","client"],r=["bot","assistant","agent","chatbot","ai","system"],u=S.toLowerCase();return l.includes(u)?"user":r.includes(u)?"bot":"unknown"}function Et(S){const l=["speak to a human","speak to someone","transfer me","real person","human agent","customer service","supervisor","manager","escalate","can't help","don't understand"],r=S.map(u=>(u.content||"").toLowerCase()).join(" ");return l.some(u=>r.includes(u))}function Tt(S){const l=["order number","order status","tracking","shipment","delivery","purchase","bought","ordered","payment","receipt"],r=S.map(u=>(u.content||"").toLowerCase()).join(" ");return l.some(u=>r.includes(u))}function Rt(S){return S.filter(l=>ze(l.role||"")==="user").length}function It(S){return S.filter(l=>ze(l.role||"")==="bot").length}function zt(S){if(!S||S.length===0)return{totalConversations:0,totalMessages:0,avgMessagesPerConversation:0,escalationRate:0,avgUserTurns:0,avgBotTurns:0};const l=S.reduce((t,a)=>t+a.messages.length,0),r=S.filter(t=>t.metadata.hasEscalation).length,u=S.reduce((t,a)=>t+a.metadata.userTurns,0),s=S.reduce((t,a)=>t+a.metadata.botTurns,0);return{totalConversations:S.length,totalMessages:l,avgMessagesPerConversation:(l/S.length).toFixed(1),escalationRate:(r/S.length*100).toFixed(1),avgUserTurns:(u/S.length).toFixed(1),avgBotTurns:(s/S.length).toFixed(1)}}function Ot(){const{state:S,actions:l}=_e(),{uploadedFiles:r,parsedTranscripts:u}=S,[s,t]=ie.useState(!1),[a,i]=ie.useState(!1),o=ie.useRef(null),g=ie.useCallback(x=>{x.preventDefault(),t(!0)},[]),b=ie.useCallback(x=>{x.preventDefault(),t(!1)},[]),f=ie.useCallback(async x=>{x.preventDefault(),t(!1);const k=Array.from(x.dataTransfer.files);await d(k)},[]),p=ie.useCallback(async x=>{const k=Array.from(x.target.files);await d(k),x.target.value=""},[]),d=async x=>{const k=x.filter(A=>A.name.endsWith(".txt")||A.name.endsWith(".json")||A.name.endsWith(".zip"));if(k.length===0){alert("Please upload .txt, .json, or .zip files");return}i(!0);try{const A=k.map(W=>({name:W.name,size:W.size,type:W.type,file:W,status:"processing"}));l.addUploadedFiles(A);const C=await kt(k),z=At(C),L=[...S.uploadedFiles,...A].map(W=>{var F;const R=C.find(K=>K.filename===W.name);return{...W,status:R!=null&&R.error?"error":"success",error:R==null?void 0:R.error,transcriptCount:((F=R==null?void 0:R.transcripts)==null?void 0:F.length)||0}});l.setUploadedFiles(L),l.setParsedTranscripts([...u,...z])}catch(A){console.error("Error processing files:",A)}finally{i(!1)}},y=x=>{const k=r[x],A=r.filter((z,L)=>L!==x);l.setUploadedFiles(A);const C=u.filter(z=>z.sourceFile!==k.name);l.setParsedTranscripts(C)},h=()=>{l.setUploadedFiles([]),l.setParsedTranscripts([])},v=zt(u),m=x=>x.endsWith(".json")?"üìã":x.endsWith(".zip")?"üì¶":"üìÑ";return e.jsxs("div",{className:"file-upload",children:[e.jsxs("div",{className:"file-upload-header",children:[e.jsxs("h2",{className:"file-upload-title",children:[e.jsx("span",{children:"üìÅ"}),"Upload Transcripts"]}),r.length>0&&e.jsxs("span",{className:"badge badge-primary",children:[r.length," files"]})]}),e.jsxs("div",{className:"file-upload-body",children:[e.jsxs("div",{className:`dropzone ${s?"dragging":""}`,onDragOver:g,onDragLeave:b,onDrop:f,onClick:()=>{var x;return(x=o.current)==null?void 0:x.click()},children:[e.jsx("input",{ref:o,type:"file",multiple:!0,accept:".txt,.json,.zip",onChange:p,style:{display:"none"}}),e.jsx("span",{className:"dropzone-icon",children:a?"‚è≥":"üì§"}),e.jsx("p",{className:"dropzone-text",children:a?"Processing files...":"Drop transcript files here or click to browse"}),e.jsx("p",{className:"dropzone-hint",children:"Upload individual files or a ZIP containing multiple transcripts"}),e.jsxs("div",{className:"dropzone-formats",children:[e.jsx("span",{className:"dropzone-format",children:".txt"}),e.jsx("span",{className:"dropzone-format",children:".json"}),e.jsx("span",{className:"dropzone-format",children:".zip"})]})]}),r.length>0&&e.jsxs("div",{className:"file-list",children:[e.jsxs("div",{className:"file-list-header",children:[e.jsx("span",{className:"file-list-title",children:"Uploaded Files"}),e.jsx("button",{className:"file-list-clear",onClick:h,children:"Clear All"})]}),e.jsx("div",{className:"file-list-items",children:r.map((x,k)=>e.jsxs("div",{className:"file-item",children:[e.jsx("span",{className:"file-item-icon",children:m(x.name)}),e.jsxs("div",{className:"file-item-info",children:[e.jsx("div",{className:"file-item-name",children:x.name}),e.jsx("div",{className:"file-item-size",children:ft(x.size)})]}),e.jsxs("div",{className:`file-item-status ${x.status}`,children:[x.status==="processing"&&e.jsx("span",{className:"spinner"}),x.status==="success"&&e.jsxs(e.Fragment,{children:["‚úÖ ",x.transcriptCount," conversations"]}),x.status==="error"&&e.jsx(e.Fragment,{children:"‚ùå Error"})]}),e.jsx("button",{className:"file-item-remove",onClick:()=>y(k),"aria-label":"Remove file",children:"‚úï"})]},`${x.name}-${k}`))})]}),u.length>0&&e.jsxs("div",{className:"file-stats",children:[e.jsxs("div",{className:"file-stat",children:[e.jsx("div",{className:"file-stat-value",children:v.totalConversations}),e.jsx("div",{className:"file-stat-label",children:"Conversations"})]}),e.jsxs("div",{className:"file-stat",children:[e.jsx("div",{className:"file-stat-value",children:v.totalMessages}),e.jsx("div",{className:"file-stat-label",children:"Messages"})]}),e.jsxs("div",{className:"file-stat",children:[e.jsx("div",{className:"file-stat-value",children:v.avgMessagesPerConversation}),e.jsx("div",{className:"file-stat-label",children:"Avg per Conversation"})]})]})]})]})}function Lt(S,l,r,u){var i;const s=S.slice(0,100),t=(i=u.websiteContent)!=null&&i.success?`
=== SCRAPED WEBSITE CONTENT ===
The following content was extracted from the website to help you understand their categories, products, and business:

${u.websiteContent.summary||"No summary available"}
`:"";let a="";if(u.additionalContext){let o=u.additionalContext,g=!1;try{const b=u.additionalContext.trim();if(b.startsWith("{")||b.startsWith("[")){const f=JSON.parse(b);g=!0,o=`[JSON PROMPT DETECTED]
The user has provided structured JSON instructions. Parse and follow these exactly:

\`\`\`json
${JSON.stringify(f,null,2)}
\`\`\`

Key fields to extract and apply:
${Object.entries(f).map(([p,d])=>`- ${p}: ${typeof d=="object"?JSON.stringify(d):d}`).join(`
`)}`}}catch{g=!1}a=`
=== USER OVERRIDE INSTRUCTIONS (HIGHEST PRIORITY) ===
The following instructions from the user OVERRIDE any default behavior. Follow these exactly:
${g?`
[This is a structured JSON prompt - parse all fields carefully]
`:""}
${o}

=== END USER OVERRIDE ===
`}return`You are an expert eCommerce chatbot analyst. Perform a comprehensive analysis of these chatbot transcripts.

=== CRITICAL GROUNDING RULES (READ FIRST) ===
You MUST follow these rules strictly to avoid hallucinations:

1. **ONLY report what you can DIRECTLY observe** in the provided transcripts
2. **DO NOT invent or fabricate** any numbers, counts, percentages, or metrics
3. **If data is insufficient**, use null, "insufficient_data", or "not_observed"
4. **Every claim must have transcript evidence** - if you can't quote it, don't report it
5. **Use confidence labels for ALL findings**:
   - "observed" = Directly seen in transcript text (quote the evidence)
   - "inferred" = Logically derived from observed patterns (explain reasoning)
   - "assumed" = Based on domain knowledge, NOT transcript data (clearly mark as assumption)

6. **For metrics and counts**:
   - Only count what you can literally count in the transcripts
   - If you cannot count exactly, say "approximately X based on Y observed instances"
   - Never invent precise percentages or rates

7. **For recommendations**:
   - Only recommend fixes for problems you OBSERVED in transcripts
   - Do not recommend solutions for imagined problems

${a}
=== BUSINESS CONTEXT ===
Website URL: ${l}
Business Model: ${r.toUpperCase()}
Business Goal: Enhance Product Discovery
Industry Override: ${u.industry||"Auto-detect from website"}
Geography: ${u.geography||"Not specified"}
${t}
=== TRANSCRIPTS (${S.length} total, showing first ${s.length}) ===
${JSON.stringify(s,null,2)}

=== ANALYSIS REQUIRED ===
Analyze ONLY based on the provided transcripts. 

CRITICAL: This transcript data contains ONLY:
- USER lines: The exact query the user typed
- AI lines: The chatbot's text response  
- RESULTS lines: Contains STYLES (style categories) and PRODUCTS (arrays of product IDs)

=== RESULTS LINE PARSING (VERY IMPORTANT) ===
Example RESULTS line:
RESULTS: STYLES: ['Adventure Ready', 'Trail King']; PRODUCTS [['27503-298992', '24331-789'], ['27352-163', '25370-1020']]

How to parse this:
- STYLES array: ['Adventure Ready', 'Trail King'] ‚Üí 2 styles
- PRODUCTS nested arrays: [['27503-298992', '24331-789'], ['27352-163', '25370-1020']]
  ‚Üí Flatten: ['27503-298992', '24331-789', '27352-163', '25370-1020'] ‚Üí 4 product IDs
- Count EACH product ID appearance across ALL RESULTS lines
- Extract EACH style name from ALL RESULTS lines

For productInsights:
- totalProductsRecommended = sum of ALL product IDs across ALL RESULTS lines
- uniqueProductsRecommended = count of UNIQUE product IDs
- topRecommendedProducts = most frequently appearing product IDs
- styleAnalysis.totalStyles = count of UNIQUE style names
- styleAnalysis.topStyles = most frequently appearing style names

=== END RESULTS PARSING ===

- Timestamps: When each message occurred

You CANNOT determine from this data:
- Whether users clicked on results or purchased
- User satisfaction or frustration (no feedback signals)
- Whether the conversation was "successful" 
- Engagement metrics beyond turn counts

Focus your analysis on what IS observable.

{
  "sessionOverview": {
    "totalSessions": "EXACT count of sessions analyzed",
    "dateRange": {
      "start": "Earliest timestamp found",
      "end": "Latest timestamp found",
      "totalDays": "days between"
    },
    "turnAnalysis": {
      "singleTurnSessions": "count of sessions with exactly 1 user message",
      "multiTurnSessions": "count of sessions with 2+ user messages",
      "avgTurnsPerSession": "calculated average",
      "maxTurnsInSession": "highest turn count observed"
    },
    "timePatterns": {
      "busiestHour": "Hour with most sessions if determinable",
      "busiestDay": "Day of week if determinable"
    }
  },

  "queryAnalysis": {
    "overview": "Brief summary of what users are searching for",
    "totalQueries": "Total USER messages counted",
    "uniqueQueries": "Count of distinct queries",
    "allUniqueQueries": [
      {
        "query": "EXACT user query text copied verbatim",
        "frequency": "number of times this exact query appeared"
      }
    ],
    "queryCategories": [
      {
        "category": "Vehicle/Brand | Product Type | Style/Feature | Location | General",
        "count": "number of queries in this category",
        "percentage": "calculated from count",
        "examples": ["EXACT query 1", "EXACT query 2"]
      }
    ],
    "topSearchTerms": ["most common search term 1", "term 2", "term 3"],
    "queryLengthAnalysis": {
      "singleWordQueries": "count",
      "multiWordQueries": "count",
      "avgWordsPerQuery": "number"
    }
  },

  "botResponseAnalysis": {
    "overview": "How the chatbot responded to queries",
    "sessionsWithResults": {
      "count": "Sessions where RESULTS line appeared",
      "percentage": "calculated"
    },
    "sessionsWithoutResults": {
      "count": "Sessions with no RESULTS line",
      "percentage": "calculated"
    },
    "avgProductsReturned": "Average count of product IDs in RESULTS",
    "responsePatterns": [
      {
        "pattern": "Clarifying Question | Direct Results | No Results | Error",
        "count": "how many times this pattern occurred",
        "example": "EXACT AI response quote"
      }
    ],
    "clarifyingQuestions": {
      "count": "How often bot asked clarifying questions",
      "examples": ["EXACT question quote 1", "quote 2"]
    }
  },

  "productInsights": {
    "overview": "Summary of what products/styles are being recommended based on RESULTS lines",
    "totalProductsRecommended": "NUMBER - Count ALL product IDs from ALL RESULTS lines (e.g., if 37 sessions each have 30 products, total = 1110)",
    "uniqueProductsRecommended": "NUMBER - Count of DISTINCT product IDs after deduplication",
    "topRecommendedProducts": [
      {
        "productId": "Exact product ID string like '27503-298992'",
        "frequency": "NUMBER - how many times this ID appeared",
        "associatedQueries": ["user queries that resulted in this product"]
      }
    ],
    "styleAnalysis": {
      "totalStyles": "NUMBER - Count of UNIQUE style names across all RESULTS",
      "topStyles": [
        {
          "style": "Exact style name like 'Adventure Ready' or 'Government Fleet Utility'",
          "frequency": "NUMBER - how many times this style appeared",
          "exampleQueries": ["queries that triggered this style"]
        }
      ]
    }
  },

  "potentialIssues": [
    {
      "issue": "Description of potential issue",
      "type": "No Results | Ambiguous Query | Repeated Query | Very Short Session",
      "frequency": "How often observed",
      "evidence": "EXACT transcript quote",
      "caveat": "Why this is only a potential issue (no engagement data to confirm)",
      "severity": "high | medium | low"
    }
  ],

  "observations": {
    "patterns": [
      {
        "observation": "Pattern noticed in the data",
        "evidence": "Supporting data points",
        "businessRelevance": "Why this might matter"
      }
    ],
    "anomalies": [
      {
        "anomaly": "Unusual pattern or outlier",
        "details": "What makes it unusual"
      }
    ]
  },

  "recommendations": [
    {
      "id": "number",
      "title": "Clear recommendation",
      "rationale": "Why this is recommended based on observed data",
      "evidence": "Data supporting this recommendation",
      "action": "Specific action to take",
      "effort": "low | medium | high",
      "caveat": "Any limitations on this recommendation"
    }
  ],

  "dataQualityNotes": {
    "totalTranscriptsAnalyzed": "${s.length}",
    "dataLimitations": [
      "No user engagement/click data available",
      "No conversion or purchase data",
      "Cannot determine user satisfaction"
    ],
    "whatWeCannotDetermine": [
      "Whether users found what they were looking for",
      "Actual resolution or success rates",
      "User frustration or satisfaction levels"
    ],
    "analysisConfidence": "Description of overall confidence in findings"
  }
}

FINAL REMINDERS:
- Only analyze what is ACTUALLY in the transcripts
- USER lines = user queries, AI lines = bot responses, RESULTS = products returned
- Do NOT invent engagement metrics, satisfaction scores, or resolution rates
- Every finding must quote actual transcript content
- If you cannot observe something, say so explicitly
- Focus on query patterns, product recommendations, and response patterns
- Respond ONLY with valid JSON, no markdown code blocks`}function De(S,l=!0){if(!S)return null;const r=S instanceof Date?S:new Date(S);if(isNaN(r.getTime()))return null;const u={year:"numeric",month:"short",day:"numeric"};return l&&(u.hour="2-digit",u.minute="2-digit"),r.toLocaleDateString("en-US",u)}function Bt(S){if(!S||S.length===0)return Dt();const l=Ft(S),r=Ut(S),u=Pt(S),s=Wt(S),t=Mt(S),a=$t(S);return{sessionOverview:l,turnAnalysis:r,queryAnalysis:u,productInsights:s,botResponseAnalysis:t,timePatterns:a,dataQualityNotes:{totalTranscriptsAnalyzed:S.length,extractionMethod:"rule-based",dataLimitations:["No user engagement/click data available","No conversion or purchase data","Cannot determine user satisfaction"]}}}function Dt(){return{sessionOverview:{totalSessions:0,dateRange:{start:null,end:null,totalDays:0}},turnAnalysis:{singleTurnSessions:0,multiTurnSessions:0,avgTurnsPerSession:0,maxTurnsInSession:0},queryAnalysis:{totalQueries:0,uniqueQueries:[],queryLengthAnalysis:{singleWordQueries:0,multiWordQueries:0,avgWordsPerQuery:0},topSearchTerms:[]},productInsights:{totalProductsRecommended:0,uniqueProductsRecommended:0,topRecommendedProducts:[],styleAnalysis:{totalStyles:0,topStyles:[]}},botResponseAnalysis:{sessionsWithResults:{count:0,percentage:0},sessionsWithoutResults:{count:0,percentage:100},avgProductsReturned:0,clarifyingQuestions:{count:0,examples:[]}},timePatterns:{busiestHour:null,busiestDay:null,hourlyDistribution:{}},dataQualityNotes:{totalTranscriptsAnalyzed:0,extractionMethod:"rule-based"}}}function Ft(S){var u;const l=[];for(const s of S){for(const t of s.messages||[])if(t.timestamp){const a=new Date(t.timestamp);isNaN(a.getTime())||l.push(a)}if((u=s.metadata)!=null&&u.dateRange){if(s.metadata.dateRange.start){const t=new Date(s.metadata.dateRange.start);isNaN(t.getTime())||l.push(t)}if(s.metadata.dateRange.end){const t=new Date(s.metadata.dateRange.end);isNaN(t.getTime())||l.push(t)}}}let r={start:null,end:null,totalDays:0};if(l.length>0){l.sort((i,o)=>i-o);const s=l[0],t=l[l.length-1],a=Math.ceil((t-s)/(1e3*60*60*24))+1;r={start:De(s),end:De(t),startRaw:s.toISOString(),endRaw:t.toISOString(),totalDays:Math.max(1,a)}}return{totalSessions:S.length,dateRange:r}}function Ut(S){let l=0,r=0,u=0,s=0;for(const t of S){const i=(t.messages||[]).filter(o=>o.role==="user").length;i===1?l++:i>1&&r++,u+=i,s=Math.max(s,i)}return{singleTurnSessions:l,multiTurnSessions:r,avgTurnsPerSession:S.length>0?parseFloat((u/S.length).toFixed(2)):0,maxTurnsInSession:s,totalUserMessages:u,totalBotMessages:S.reduce((t,a)=>t+(a.messages||[]).filter(i=>i.role==="bot").length,0)}}function Pt(S){const l=[],r={};for(const b of S)for(const f of b.messages||[])if(f.role==="user"&&f.content){const p=f.content.trim();l.push(p);const d=p.toLowerCase();r[d]=r[d]||{query:p,frequency:0},r[d].frequency++}const u=Object.values(r).sort((b,f)=>f.frequency-b.frequency);let s=0,t=0,a=0;for(const b of l){const f=b.split(/\s+/).filter(p=>p.length>0).length;a+=f,f===1?s++:t++}const i={},o=new Set(["a","an","the","is","are","was","were","for","of","to","in","on","with","i","me","my","you","your","it","and","or","but","do","does","can","will","what","how","where","when","any","have","has"]);for(const b of l){const f=b.toLowerCase().split(/\s+/).filter(p=>p.length>2&&!o.has(p));for(const p of f)i[p]=(i[p]||0)+1}const g=Object.entries(i).sort((b,f)=>f[1]-b[1]).slice(0,20).map(([b,f])=>({term:b,count:f}));return{totalQueries:l.length,uniqueQueryCount:u.length,uniqueQueries:u.slice(0,50),allUniqueQueries:u,queryLengthAnalysis:{singleWordQueries:s,multiWordQueries:t,avgWordsPerQuery:l.length>0?parseFloat((a/l.length).toFixed(2)):0},topSearchTerms:g}}function Wt(S){var b;const l=[],r={},u=[],s={},t={},a={};for(const f of S){const p=((b=(f.messages||[]).find(d=>d.role==="user"))==null?void 0:b.content)||"unknown";for(const d of f.messages||[])if(d.role==="bot"&&d.results){if(d.results.products){const y=He(d.results.products);for(const h of y)l.push(h),r[h]=(r[h]||0)+1,t[h]||(t[h]=new Set),t[h].add(p)}if(d.results.styles){for(const y of d.results.styles)if(y&&y.trim()){const h=y.trim();u.push(h),s[h]=(s[h]||0)+1,a[h]||(a[h]=new Set),a[h].add(p)}}}}const i=Object.entries(r).sort((f,p)=>p[1]-f[1]).slice(0,20).map(([f,p])=>({productId:f,frequency:p,associatedQueries:Array.from(t[f]||[])})),o=Object.entries(s).sort((f,p)=>p[1]-f[1]).map(([f,p])=>({style:f,frequency:p,exampleQueries:Array.from(a[f]||[]).slice(0,5)})),g=new Set(l);return{totalProductsRecommended:l.length,uniqueProductsRecommended:g.size,topRecommendedProducts:i,allProductIds:Array.from(g),styleAnalysis:{totalStyles:Object.keys(s).length,totalStyleMentions:u.length,topStyles:o,allStyles:Object.keys(s)}}}function He(S){const l=[];function r(u){if(!Array.isArray(u)){u&&typeof u=="string"&&l.push(u);return}for(const s of u)Array.isArray(s)?r(s):s&&typeof s=="string"&&l.push(s)}return r(S),l}function Mt(S){var o,g,b;let l=0,r=0,u=0,s=0;const t=[];if(S.length>0){const f=S[0];console.log("üîç Analyzer - First transcript structure:",{id:f.id,messageCount:(o=f.messages)==null?void 0:o.length,firstBotMessage:(g=f.messages)==null?void 0:g.find(d=>d.role==="bot")});const p=(b=f.messages)==null?void 0:b.find(d=>d.results);console.log("üîç Analyzer - Message with results in first transcript:",p?"YES":"NO")}const a=[/which\s+(location|state|city|area|option)/i,/would you like me to/i,/can you (tell|clarify|specify)/i,/what (type|kind|model|year)/i,/are you looking for/i,/do you (want|need|prefer)/i,/could you (be more specific|clarify)/i];for(const f of S){let p=!1;for(const d of f.messages||[])if(d.role==="bot"){if(d.results&&(p=!0,d.results.products)){const y=He(d.results.products);u+=y.length,s++}if(d.content){for(const y of a)if(y.test(d.content)){t.push({content:d.content.slice(0,200),sessionId:f.id});break}}}p?l++:r++}const i=S.length;return{sessionsWithResults:{count:l,percentage:i>0?parseFloat((l/i*100).toFixed(1)):0},sessionsWithoutResults:{count:r,percentage:i>0?parseFloat((r/i*100).toFixed(1)):0},avgProductsReturned:s>0?parseFloat((u/s).toFixed(1)):0,clarifyingQuestions:{count:t.length,examples:t.slice(0,10)}}}function $t(S){const l={},r={},u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(const o of S){const g=(o.messages||[])[0];if(g!=null&&g.timestamp){const b=new Date(g.timestamp);if(!isNaN(b.getTime())){const f=b.getHours(),p=u[b.getDay()];l[f]=(l[f]||0)+1,r[p]=(r[p]||0)+1}}}let s=null,t=0;for(const[o,g]of Object.entries(l))g>t&&(t=g,s=parseInt(o));let a=null,i=0;for(const[o,g]of Object.entries(r))g>i&&(i=g,a=o);return{busiestHour:s!==null?qt(s):null,busiestDay:a,hourlyDistribution:l,dailyDistribution:r}}function qt(S){const l=S>=12?"PM":"AM",r=S%12||12,u=(S+1)%24,s=u>=12?"PM":"AM",t=u%12||12;return`${r}:00 ${l} - ${t}:00 ${s}`}function Qt(S){var a;if(!S||S.length===0)return Ht();const l={singleWord:0,simplePhrase:0,advancedSearch:0,naturalLanguage:0,examples:{singleWord:[],simplePhrase:[],advancedSearch:[],naturalLanguage:[]}},r={sessionsWithRepeats:0,totalRepeats:0,examples:[]},u={productSearch:0,locationQuery:0,priceInquiry:0,supportRequest:0,categoryBrowse:0,specificItem:0},s={location:/\b(near|in|at|around|close to|nearby)\s+(me|my|location|\w+,?\s*\w*)/i,price:/\b(price|cost|under|below|above|budget|\$\d+|cheap|expensive|affordable)/i,support:/\b(help|issue|problem|error|can'?t|unable|locked|not working|broken)/i,naturalLanguage:/\b(i'?m|i am|i want|i need|looking for|searching for|trying to find|do you have)/i,specificItem:/\b([A-Z]{2,}\s*[-]?\s*\d+|\d{4,}|model|sku|item\s*#)/i};for(const i of S){const o=(i.messages||[]).filter(f=>f.role==="user"),g=[];for(const f of o){const p=((a=f.content)==null?void 0:a.trim())||"";if(!p)continue;g.push(p.toLowerCase());const d=p.split(/\s+/).filter(y=>y.length>0).length;d===1?(l.singleWord++,l.examples.singleWord.length<5&&l.examples.singleWord.push(p)):s.naturalLanguage.test(p)?(l.naturalLanguage++,l.examples.naturalLanguage.length<5&&l.examples.naturalLanguage.push(p)):d>=5||s.location.test(p)&&s.price.test(p)?(l.advancedSearch++,l.examples.advancedSearch.length<5&&l.examples.advancedSearch.push(p)):(l.simplePhrase++,l.examples.simplePhrase.length<5&&l.examples.simplePhrase.push(p)),s.support.test(p)?u.supportRequest++:s.location.test(p)&&u.locationQuery++,s.price.test(p)&&u.priceInquiry++,s.specificItem.test(p)?u.specificItem++:d<=2&&!s.location.test(p)&&!s.support.test(p)?u.categoryBrowse++:u.productSearch++}const b=new Set(g);if(g.length>b.size){r.sessionsWithRepeats++;const f=g.length-b.size;r.totalRepeats+=f;const p={};for(const d of g)p[d]=(p[d]||0)+1;for(const[d,y]of Object.entries(p))y>1&&r.examples.length<5&&r.examples.push({query:d,count:y,sessionId:i.id})}}const t=l.singleWord+l.simplePhrase+l.advancedSearch+l.naturalLanguage;return{queryComplexity:{...l,total:t,percentages:{singleWord:t>0?Math.round(l.singleWord/t*100):0,simplePhrase:t>0?Math.round(l.simplePhrase/t*100):0,advancedSearch:t>0?Math.round(l.advancedSearch/t*100):0,naturalLanguage:t>0?Math.round(l.naturalLanguage/t*100):0}},repeatedQueries:{...r,percentage:S.length>0?Math.round(r.sessionsWithRepeats/S.length*100):0},intentCategories:u,insights:Zt(l,r,u,t,S.length)}}function Zt(S,l,r,u,s){const t=[],a=u>0?S.singleWord/u*100:0;return a>50?t.push({type:"warning",title:"Basic Search Behavior",message:`${Math.round(a)}% of queries are single words. Users may not know the chatbot can handle complex searches.`,recommendation:'Consider adding prompts like "Try: iPad Pro near Austin under $500"'}):S.advancedSearch>S.singleWord&&t.push({type:"positive",title:"Advanced Search Usage",message:"Users are leveraging advanced search features with multi-criteria queries.",recommendation:"Continue promoting complex search capabilities."}),l.sessionsWithRepeats>s*.1&&t.push({type:"warning",title:"Query Repetition Detected",message:`${l.percentage}% of sessions have repeated queries, suggesting users aren't finding what they need.`,recommendation:"Review bot responses for these repeated queries and improve clarity."}),r.locationQuery>u*.2&&t.push({type:"info",title:"Location-Based Searches Popular",message:"Many users include location in their searches.",recommendation:"Ensure location-based filtering is prominent in the UI."}),r.supportRequest>0&&t.push({type:"warning",title:"Support Requests via Chatbot",message:`${r.supportRequest} queries appear to be support requests, not product searches.`,recommendation:"Consider adding a support handoff option for non-product queries."}),t}function Ht(){return{queryComplexity:{singleWord:0,simplePhrase:0,advancedSearch:0,naturalLanguage:0,total:0,percentages:{singleWord:0,simplePhrase:0,advancedSearch:0,naturalLanguage:0},examples:{singleWord:[],simplePhrase:[],advancedSearch:[],naturalLanguage:[]}},repeatedQueries:{sessionsWithRepeats:0,totalRepeats:0,percentage:0,examples:[]},intentCategories:{productSearch:0,locationQuery:0,priceInquiry:0,supportRequest:0,categoryBrowse:0,specificItem:0},insights:[]}}async function Gt(S){const{transcripts:l,websiteUrl:r,businessModel:u,businessContext:s,llmConfig:t,onProgress:a}=S,i={timestamp:new Date().toISOString(),transcriptCount:l.length,websiteUrl:r,businessModel:u,businessContext:s,llmEnabled:!!t};try{a==null||a("parsing",10),await yt(300),a==null||a("metrics",25);const o=Bt(l);console.log("‚úÖ Rule-based metrics extracted:",o),a==null||a("behavior",35);const g=Qt(l);console.log("‚úÖ User behavior analyzed:",g);let b=null;if(t){a==null||a("intents",50),console.log("ü§ñ LLM configured, running AI analysis..."),xe.configure(t.provider,t.model,t.apiKey);const f=Lt(l,r,u,s);a==null||a("scoring",70);const p=await xe.complete(f,{maxTokens:8e3,temperature:.2});a==null||a("friction",85),b=xe.parseJsonResponse(p),console.log("‚úÖ LLM analysis received:",b)}else console.log("‚ÑπÔ∏è LLM not configured - skipping AI analysis, using rule-based metrics only"),a==null||a("scoring",70);return a==null||a("recommendations",95),i.analysis={potentialIssues:(b==null?void 0:b.potentialIssues)||[],recommendations:(b==null?void 0:b.recommendations)||[],observations:(b==null?void 0:b.observations)||{},sessionOverview:{totalSessions:o.sessionOverview.totalSessions,dateRange:o.sessionOverview.dateRange,turnAnalysis:o.turnAnalysis,timePatterns:o.timePatterns},queryAnalysis:{totalQueries:o.queryAnalysis.totalQueries,uniqueQueries:o.queryAnalysis.uniqueQueryCount,allUniqueQueries:o.queryAnalysis.allUniqueQueries,queryLengthAnalysis:o.queryAnalysis.queryLengthAnalysis,topSearchedQueries:o.queryAnalysis.allUniqueQueries.slice(0,15)},botResponseAnalysis:{sessionsWithResults:o.botResponseAnalysis.sessionsWithResults,sessionsWithoutResults:o.botResponseAnalysis.sessionsWithoutResults,avgProductsReturned:o.botResponseAnalysis.avgProductsReturned,clarifyingQuestions:o.botResponseAnalysis.clarifyingQuestions},userBehavior:g,productInsights:o.productInsights,dataQualityNotes:o.dataQualityNotes},i.ruleBasedMetrics=o,i.userBehavior=g,i.llmAnalysis=b,i.success=!0,a==null||a("complete",100),i}catch(o){throw console.error("Analysis failed:",o),i.success=!1,i.error=o.message,o}}const Yt="https://r.jina.ai/";async function Ie(S){try{const l=await fetch(Yt+encodeURIComponent(S),{headers:{Accept:"text/plain"}});if(!l.ok)throw new Error(`Failed to fetch: ${l.status}`);const r=await l.text();return{url:S,content:r,success:!0}}catch(l){return console.error(`Error fetching ${S}:`,l),{url:S,content:null,success:!1,error:l.message}}}async function Kt(S){const l=[`${S}/sitemap.xml`,`${S}/sitemap_index.xml`,`${S}/sitemap/sitemap.xml`];for(const r of l)try{const u=`https://api.allorigins.win/raw?url=${encodeURIComponent(r)}`,s=await fetch(u);if(!s.ok)continue;const t=await s.text();if(!t.includes("<urlset")&&!t.includes("<sitemapindex"))continue;const a=Jt(t);if(a.length>0)return{success:!0,urls:a,source:r}}catch{console.log(`Sitemap not found at ${r}`)}return{success:!1,urls:[],error:"No sitemap found"}}function Jt(S){const l=[],u=new DOMParser().parseFromString(S,"text/xml"),s=u.querySelectorAll("sitemap > loc");return s.length>0&&s.forEach(a=>{l.push({url:a.textContent,type:"sitemap"})}),u.querySelectorAll("url > loc").forEach(a=>{l.push({url:a.textContent,type:"page"})}),l}function Vt(S,l=5){const r=[/\/collections?\//i,/\/categor(y|ies)\//i,/\/shop\//i,/\/products?\//i,/\/department/i];return S.filter(s=>s.type==="page").filter(s=>r.some(t=>t.test(s.url))).slice(0,l).map(s=>s.url)}function Xt(S,l=3){const r=[/\/products?\//i,/\/item\//i,/\/p\//i,/\/dp\//i];return S.filter(s=>s.type==="page").filter(s=>new URL(s.url).pathname.split("/").filter(Boolean).length>=2&&r.some(i=>i.test(s.url))).slice(0,l).map(s=>s.url)}async function es(S,l){const r={homepage:null,categories:[],products:[],sitemap:null,summary:null};try{const u=new URL(S).origin;if(l==null||l("Fetching homepage...",10),r.homepage=await Ie(u),l==null||l("Looking for sitemap...",30),r.sitemap=await Kt(u),r.sitemap.success&&r.sitemap.urls.length>0){l==null||l("Analyzing category pages...",50);const s=Vt(r.sitemap.urls,3);for(const a of s){const i=await Ie(a);i.success&&r.categories.push(i)}l==null||l("Analyzing product pages...",70);const t=Xt(r.sitemap.urls,2);for(const a of t){const i=await Ie(a);i.success&&r.products.push(i)}}return l==null||l("Generating summary...",90),r.summary=ts(r),l==null||l("Complete!",100),{success:!0,...r}}catch(u){return console.error("Website scraping failed:",u),{success:!1,error:u.message,...r}}}function ts(S){var r,u;const l=[];if((r=S.homepage)!=null&&r.success){const s=S.homepage.content.slice(0,2e3);l.push(`## Homepage Content
${s}`)}if(S.categories.length>0&&(l.push(`## Category Pages (${S.categories.length} found)`),S.categories.forEach(s=>{if(s.success){const t=s.content.slice(0,1e3);l.push(`### ${s.url}
${t}`)}})),S.products.length>0&&(l.push(`## Product Pages (${S.products.length} found)`),S.products.forEach(s=>{if(s.success){const t=s.content.slice(0,800);l.push(`### ${s.url}
${t}`)}})),(u=S.sitemap)!=null&&u.success){const s=S.sitemap.urls.length;l.push(`## Site Structure
- Sitemap found with ${s} URLs`)}return l.join(`

`)}function ss(){var W,R;const{state:S,actions:l}=_e(),{llmConfig:r,parsedTranscripts:u,businessContext:s,analysis:t}=S,[a,i]=ie.useState(!1),[o,g]=ie.useState(!1),[b,f]=ie.useState(""),p=(F,K)=>{l.setBusinessContext({[F]:K})},d=async()=>{if(!(!m||o)){g(!0),f("Starting...");try{const F=await es(s.websiteUrl,(K,j)=>{f(K)});l.setBusinessContext({websiteContent:F}),f(F.success?"Content fetched!":"Partial fetch")}catch(F){console.error("Website fetch failed:",F),f("Failed to fetch")}finally{g(!1),setTimeout(()=>f(""),3e3)}}},y=async()=>{if(k){l.startAnalysis();try{xe.configure(r.provider,r.model,r.apiKey);const F=await Gt({transcripts:u,websiteUrl:s.websiteUrl,businessModel:s.businessModel,businessContext:{industry:s.industry,geography:s.geography,additionalContext:s.additionalContext,websiteContent:s.websiteContent},llmConfig:h?r:null,onProgress:(K,j)=>{l.updateProgress(K,j)}});l.setResults(F),l.finishAnalysis()}catch(F){console.error("Analysis failed:",F),l.setAnalysisError(F.message)}}},h=r.isConnected&&r.apiKey,v=u.length>0,m=s.websiteUrl&&gt(s.websiteUrl),x=(W=s.websiteContent)==null?void 0:W.success,k=v&&m&&!t.isRunning,A=JSON.stringify(u),C=St(A),L=(R=xe.estimateCost)==null?void 0:R.call(xe,C,4e3);return e.jsxs("div",{className:"analysis-dashboard",children:[e.jsx("div",{className:"analysis-dashboard-header",children:e.jsxs("h2",{className:"analysis-dashboard-title",children:[e.jsx("span",{children:"üéØ"}),"Analysis Configuration"]})}),e.jsxs("div",{className:"analysis-dashboard-body",children:[e.jsxs("div",{className:"business-context-section",children:[e.jsxs("div",{className:"context-row",children:[e.jsxs("div",{className:"form-group website-url-group",children:[e.jsx("label",{className:"form-label",htmlFor:"websiteUrl",children:"Website URL"}),e.jsxs("div",{className:"website-url-input-wrapper",children:[e.jsx("input",{id:"websiteUrl",type:"url",className:"form-input",placeholder:"https://example.com",value:s.websiteUrl,onChange:F=>p("websiteUrl",F.target.value)}),e.jsx("button",{type:"button",className:`btn btn-secondary fetch-website-btn ${x?"fetched":""}`,onClick:d,disabled:!m||o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Fetching..."]}):x?e.jsx(e.Fragment,{children:"‚úì Fetched"}):e.jsx(e.Fragment,{children:"üîç Fetch Content"})})]}),b&&e.jsx("p",{className:"fetch-progress",children:b}),e.jsx("p",{className:"form-hint",children:`Click "Fetch Content" to analyze your site's categories and products for better analysis`})]}),e.jsxs("div",{className:"form-group business-model-toggle",children:[e.jsx("label",{className:"form-label",children:"Business Model"}),e.jsx("div",{className:"toggle-group",children:Object.values(it).map(F=>e.jsx("button",{type:"button",className:`toggle-option ${s.businessModel===F.id?"active":""}`,onClick:()=>p("businessModel",F.id),children:F.name},F.id))})]})]}),e.jsxs("div",{className:"optional-context",children:[e.jsxs("button",{type:"button",className:"optional-context-toggle",onClick:()=>i(!a),children:[e.jsx("span",{children:a?"‚ñº":"‚ñ∂"}),"Optional: Additional Business Context"]}),a&&e.jsxs("div",{className:"optional-context-fields",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"industry",children:"Industry Override"}),e.jsx("input",{id:"industry",type:"text",className:"form-input",placeholder:"e.g., Electronics, Fashion",value:s.industry,onChange:F=>p("industry",F.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"geography",children:"Geography / Language"}),e.jsx("input",{id:"geography",type:"text",className:"form-input",placeholder:"e.g., North America, English",value:s.geography,onChange:F=>p("geography",F.target.value)})]}),e.jsxs("div",{className:"form-group additional-context-group",children:[e.jsx("label",{className:"form-label",htmlFor:"additionalContext",children:"Additional Context"}),e.jsx("textarea",{id:"additionalContext",className:"form-textarea",placeholder:"Provide any additional context about your website, products, or specific areas you want the analysis to focus on. This helps the LLM understand your business better.",value:s.additionalContext,onChange:F=>p("additionalContext",F.target.value),rows:3})]})]})]})]}),e.jsx("div",{className:"analysis-actions",children:e.jsxs("div",{className:"analysis-actions-content",children:[e.jsx("button",{className:"btn btn-primary run-analysis-btn",onClick:y,disabled:!k,children:t.isRunning?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Analyzing..."]}):e.jsx(e.Fragment,{children:"üöÄ Run Analysis"})}),e.jsxs("div",{className:"analysis-requirements",children:[e.jsxs("span",{className:`requirement-badge ${h?"met":"optional"}`,children:[h?"‚úì":"‚óã"," LLM ",h?"Connected":"(Optional)"]}),e.jsxs("span",{className:`requirement-badge ${v?"met":"unmet"}`,children:[v?"‚úì":"‚óã"," Transcripts Uploaded"]}),e.jsxs("span",{className:`requirement-badge ${m?"met":"unmet"}`,children:[m?"‚úì":"‚óã"," Website URL"]})]}),L&&v&&e.jsxs("div",{className:"cost-estimate",children:[e.jsxs("span",{children:["Est. tokens: ~",(C/1e3).toFixed(1),"K"]}),L.totalCost>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"‚Ä¢"}),e.jsxs("span",{children:["Est. cost: ",e.jsxs("span",{className:"cost-estimate-value",children:["$",L.totalCost.toFixed(4)]})]})]})]})]})})]})]})}function rs({currentStage:S,progress:l,error:r}){const u=s=>{const t=Re.findIndex(i=>i.id===S),a=Re.findIndex(i=>i.id===s);return a<t?"completed":a===t?"active":"pending"};return e.jsxs("div",{className:"progress-container",children:[e.jsxs("div",{className:"progress-header",children:[e.jsxs("h3",{className:"progress-title",children:[e.jsx("span",{className:"spinner-lg"}),"Analyzing Transcripts..."]}),e.jsxs("span",{className:"progress-percentage",children:[Math.round(l),"%"]})]}),e.jsx("div",{className:"progress-bar-wrapper",children:e.jsx("div",{className:"progress-bar-fill",style:{width:`${l}%`}})}),e.jsx("div",{className:"progress-stages",children:Re.map(s=>{const t=u(s.id);return e.jsxs("div",{className:`progress-stage ${t}`,children:[e.jsx("span",{className:"progress-stage-icon",children:s.icon}),e.jsx("span",{className:"progress-stage-name",children:s.name})]},s.id)})}),r&&e.jsxs("div",{className:"progress-error",children:[e.jsxs("div",{className:"progress-error-title",children:[e.jsx("span",{children:"‚ùå"}),"Analysis Error"]}),e.jsx("p",{className:"progress-error-message",children:r})]})]})}function ns(S,l="chatbot-analysis"){const r=os(S);vt(r,`${l}.md`,"text/markdown")}function is(S,l="chatbot-analysis"){const r=as(S,l),u=window.open("","_blank");u.document.write(r),u.document.close()}function as(S,l="chatbot-analysis"){var p,d,y,h,v,m,x,k,A,C;const r=(S==null?void 0:S.analysis)||{},u=r.sessionOverview||{},s=r.queryAnalysis||{};r.botResponseAnalysis;const t=r.potentialIssues||[],a=r.recommendations||[];r.dataQualityNotes;let i=`<!DOCTYPE html>
<html>
<head>
    <title>${l}</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #1e293b;
            background: #fff;
        }
        .page {
            page-break-after: always;
            padding: 40px;
            min-height: 100vh;
        }
        .page:last-child { page-break-after: auto; }
        .page-header {
            background: #82C8E5;
            margin: -40px -40px 30px -40px;
            padding: 20px 40px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .page-header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #1e293b;
        }
        .page-header .icon { font-size: 28px; }
        h2 { color: #334155; font-size: 18px; margin: 24px 0 12px; }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }
        .metric-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        .metric-label { font-size: 12px; color: #64748b; margin-bottom: 4px; }
        .metric-value { font-size: 24px; font-weight: 700; color: #6366f1; }
        .metric-value.positive { color: #10b981; }
        .metric-value.warning { color: #f59e0b; }
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }
        .badge-success { background: #dcfce7; color: #166534; }
        .badge-warning { background: #fef3c7; color: #92400e; }
        .badge-danger { background: #fee2e2; color: #991b1b; }
        .badge-primary { background: #e0e7ff; color: #3730a3; }
        .badge-neutral { background: #f1f5f9; color: #475569; }
        .item-card {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-left: 4px solid #6366f1;
            border-radius: 8px;
            padding: 16px;
            margin: 12px 0;
        }
        .item-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }
        .item-number {
            background: #6366f1;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        .item-title { font-weight: 600; color: #1e293b; }
        .item-desc { color: #64748b; font-size: 14px; margin-top: 8px; }
        table { width: 100%; border-collapse: collapse; margin: 16px 0; }
        th, td { border: 1px solid #e2e8f0; padding: 10px 14px; text-align: left; font-size: 13px; }
        th { background: #f8fafc; font-weight: 600; color: #475569; }
        .evidence-box {
            background: #f8fafc;
            border-left: 3px solid #94a3b8;
            padding: 12px;
            margin: 8px 0;
            font-style: italic;
            font-size: 13px;
            color: #64748b;
        }
        .warning-box {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid #f59e0b;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        @media print {
            .page { padding: 20px; }
            .page-header { margin: -20px -20px 20px -20px; padding: 15px 20px; }
        }
    </style>
</head>
<body>`;i+=`
    <div class="page">
        <div class="page-header">
            <span class="icon">üìä</span>
            <h1>Session Overview</h1>
        </div>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Total Sessions</div>
                <div class="metric-value positive">${u.totalSessions||"N/A"}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Date Range</div>
                <div class="metric-value" style="font-size: 16px;">
                    ${((p=u.dateRange)==null?void 0:p.start)||"N/A"} - ${((d=u.dateRange)==null?void 0:d.end)||"N/A"}
                </div>
            </div>
        </div>
        <h2>Turn Analysis</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Single-Turn Sessions</div>
                <div class="metric-value">${((y=u.turnAnalysis)==null?void 0:y.singleTurnSessions)||0}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Multi-Turn Sessions</div>
                <div class="metric-value positive">${((h=u.turnAnalysis)==null?void 0:h.multiTurnSessions)||0}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Avg Turns/Session</div>
                <div class="metric-value">${((v=u.turnAnalysis)==null?void 0:v.avgTurnsPerSession)||"N/A"}</div>
            </div>
        </div>
    </div>`,i+=`
    <div class="page">
        <div class="page-header">
            <span class="icon">üîç</span>
            <h1>Query Analysis</h1>
        </div>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Total Queries</div>
                <div class="metric-value">${s.totalQueries||0}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Unique Queries</div>
                <div class="metric-value">${s.uniqueQueries||0}</div>
            </div>
        </div>`,((m=s.allUniqueQueries)==null?void 0:m.length)>0&&(i+=`
        <h2>Top Queries</h2>
        <table>
            <tr><th>Query</th><th>Count</th></tr>`,s.allUniqueQueries.slice(0,15).forEach(z=>{i+=`<tr><td>${z.query||""}</td><td style="text-align: center;">${z.frequency||0}</td></tr>`}),i+="</table>"),i+="</div>";const o=r.userBehavior||{},g=o.queryComplexity||{},b=o.intentCategories||{},f=o.insights||[];return i+=`
    <div class="page">
        <div class="page-header">
            <span class="icon">üë§</span>
            <h1>User Insights</h1>
        </div>
        <h2>Query Complexity</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Single Word</div>
                <div class="metric-value">${g.singleWord||0}</div>
                <div style="font-size: 12px; color: #64748b;">${((x=g.percentages)==null?void 0:x.singleWord)||0}%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Simple Phrase</div>
                <div class="metric-value">${g.simplePhrase||0}</div>
                <div style="font-size: 12px; color: #64748b;">${((k=g.percentages)==null?void 0:k.simplePhrase)||0}%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Advanced Search</div>
                <div class="metric-value positive">${g.advancedSearch||0}</div>
                <div style="font-size: 12px; color: #64748b;">${((A=g.percentages)==null?void 0:A.advancedSearch)||0}%</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Natural Language</div>
                <div class="metric-value positive">${g.naturalLanguage||0}</div>
                <div style="font-size: 12px; color: #64748b;">${((C=g.percentages)==null?void 0:C.naturalLanguage)||0}%</div>
            </div>
        </div>
        <h2>Intent Categories</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Product Search</div>
                <div class="metric-value">${b.productSearch||0}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Location Query</div>
                <div class="metric-value">${b.locationQuery||0}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Category Browse</div>
                <div class="metric-value">${b.categoryBrowse||0}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Support Request</div>
                <div class="metric-value" style="color: ${b.supportRequest>0?"#f59e0b":"#6366f1"};">${b.supportRequest||0}</div>
            </div>
        </div>`,f.length>0&&(i+="<h2>Key Insights</h2>",f.forEach(z=>{i+=`
            <div class="item-card" style="border-left-color: ${z.type==="warning"?"#f59e0b":z.type==="positive"?"#10b981":"#6366f1"};">
                <div class="item-header">
                    <span class="item-title">${z.type==="warning"?"‚ö†Ô∏è":z.type==="positive"?"‚úÖ":"‚ÑπÔ∏è"} ${z.title}</span>
                </div>
                <p style="font-size: 13px; color: #64748b; margin: 8px 0;">${z.message}</p>
                ${z.recommendation?`<p style="font-size: 12px; color: #6366f1;">üí° ${z.recommendation}</p>`:""}
            </div>`})),i+="</div>",i+=`
    <div class="page">
        <div class="page-header">
            <span class="icon">‚ö†Ô∏è</span>
            <h1>Issues and Recommendations</h1>
        </div>
        <p style="color: #64748b; font-size: 13px; margin-bottom: 16px;">
            Note: These are potential issues inferred from patterns. Without engagement data, impact cannot be confirmed.
        </p>`,t.length>0&&(i+=`<h2>Potential Issues (${t.length})</h2>`,t.slice(0,5).forEach(z=>{i+=`
            <div class="item-card" style="border-left-color: ${z.severity==="high"?"#ef4444":"#f59e0b"};">
                <div class="item-header">
                    <span class="item-title">${z.issue||""}</span>
                    <span class="badge ${z.severity==="high"?"badge-danger":"badge-warning"}">${z.severity||""}</span>
                </div>
            </div>`})),a.length>0&&(i+=`<h2>Recommendations (${a.length})</h2>`,a.slice(0,5).forEach((z,L)=>{i+=`
            <div class="item-card">
                <div class="item-header">
                    <span class="item-number">${L+1}</span>
                    <span class="item-title">${z.title||""}</span>
                    <span class="badge ${z.effort==="low"?"badge-success":"badge-warning"}">${z.effort||""} effort</span>
                </div>
                ${z.action?'<div class="item-desc">'+z.action+"</div>":""}
            </div>`})),i+=`
    </div>
    <script>
        window.onload = function() {
            window.print();
        };
    <\/script>
</body>
</html>`,i}function os(S){var p,d,y,h,v,m,x;const l=(S==null?void 0:S.analysis)||{},r=l.sessionOverview||{},u=l.queryAnalysis||{};l.botResponseAnalysis;const s=l.userBehavior||{},t=l.potentialIssues||[],a=l.recommendations||[],i=l.dataQualityNotes||{};let o=`# Chatbot Transcript Analysis Report

`;o+=`## Session Overview
`,o+=`- **Total Sessions**: ${r.totalSessions||"N/A"}
`,o+=`- **Single-Turn Sessions**: ${((p=r.turnAnalysis)==null?void 0:p.singleTurnSessions)||0}
`,o+=`- **Multi-Turn Sessions**: ${((d=r.turnAnalysis)==null?void 0:d.multiTurnSessions)||0}

`,o+=`## Query Analysis
`,o+=`- **Total Queries**: ${u.totalQueries||0}
`,o+=`- **Unique Queries**: ${u.uniqueQueries||0}

`;const g=s.queryComplexity||{},b=s.intentCategories||{},f=s.insights||[];return o+=`## User Insights

`,o+=`### Query Complexity
`,o+=`| Type | Count | Percentage |
`,o+=`|------|-------|------------|
`,o+=`| Single Word | ${g.singleWord||0} | ${((y=g.percentages)==null?void 0:y.singleWord)||0}% |
`,o+=`| Simple Phrase | ${g.simplePhrase||0} | ${((h=g.percentages)==null?void 0:h.simplePhrase)||0}% |
`,o+=`| Advanced Search | ${g.advancedSearch||0} | ${((v=g.percentages)==null?void 0:v.advancedSearch)||0}% |
`,o+=`| Natural Language | ${g.naturalLanguage||0} | ${((m=g.percentages)==null?void 0:m.naturalLanguage)||0}% |

`,o+=`### Intent Categories
`,o+=`- **Product Search**: ${b.productSearch||0}
`,o+=`- **Location Query**: ${b.locationQuery||0}
`,o+=`- **Category Browse**: ${b.categoryBrowse||0}
`,o+=`- **Support Request**: ${b.supportRequest||0}

`,f.length>0&&(o+=`### Key Insights
`,f.forEach(k=>{const A=k.type==="warning"?"‚ö†Ô∏è":k.type==="positive"?"‚úÖ":"‚ÑπÔ∏è";o+=`- ${A} **${k.title}**: ${k.message}
`,k.recommendation&&(o+=`  - üí° ${k.recommendation}
`)}),o+=`
`),t.length>0&&(o+=`## Potential Issues
`,t.forEach(k=>{o+=`- **${k.issue}** (${k.severity})
`}),o+=`
`),a.length>0&&(o+=`## Recommendations
`,a.forEach((k,A)=>{o+=`${A+1}. **${k.title}** (${k.effort} effort)
`}),o+=`
`),((x=i.dataLimitations)==null?void 0:x.length)>0&&(o+=`## Data Limitations
`,i.dataLimitations.forEach(k=>{o+=`- ${k}
`})),o+=`
---
*Generated by Chatbot Analyzer*
`,o}function ls(){const{state:S}=_e(),{results:l,activeTab:r}=S,{actions:u}=_e(),[s,t]=ie.useState(!1),[a,i]=ie.useState(!1),o=l==null?void 0:l.analysis;ie.useEffect(()=>{var f,p;l&&(console.group("üìä Analysis Results Debug"),console.log("Full results object:",l),console.log("Analysis object:",o),console.log("Executive Summary:",o==null?void 0:o.executiveSummary),console.log("Health Metrics:",o==null?void 0:o.healthMetrics),console.log("Key Findings type:",typeof((f=o==null?void 0:o.executiveSummary)==null?void 0:f.keyFindings)),console.log("Key Findings:",(p=o==null?void 0:o.executiveSummary)==null?void 0:p.keyFindings),console.groupEnd())},[l,o]);const g=f=>{t(!1);const p=`chatbot-analysis-${new Date().toISOString().split("T")[0]}`;switch(f){case"pdf":is(l,p);break;case"markdown":ns(l,p);break}};if(!l)return e.jsx("div",{className:"report-viewer",children:e.jsxs("div",{className:"no-results",children:[e.jsx("span",{className:"no-results-icon",children:"üìä"}),e.jsx("h3",{className:"no-results-title",children:"No Analysis Results"}),e.jsx("p",{className:"no-results-text",children:"Configure the LLM, upload transcripts, and run analysis to see results here."})]})});const b=()=>{var f,p;switch(r){case"siteInfo":return e.jsx(Fe,{websiteContent:(f=l==null?void 0:l.businessContext)==null?void 0:f.websiteContent,llmEnabled:l==null?void 0:l.llmEnabled});case"overview":return e.jsx(cs,{analysis:o});case"queries":return e.jsx(ds,{analysis:o});case"userInsights":return e.jsx(hs,{userBehavior:o==null?void 0:o.userBehavior});case"issues":return e.jsx(us,{analysis:o});default:return e.jsx(Fe,{websiteContent:(p=l==null?void 0:l.businessContext)==null?void 0:p.websiteContent,llmEnabled:l==null?void 0:l.llmEnabled})}};return e.jsxs("div",{className:"report-viewer",children:[e.jsxs("div",{className:"report-header",children:[e.jsxs("h2",{className:"report-title",children:[e.jsx("span",{children:"üìä"}),"Analysis Results"]}),e.jsxs("div",{className:"report-actions",children:[e.jsxs("div",{className:"export-dropdown",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>t(!s),children:"üì• Export"}),s&&e.jsxs("div",{className:"export-menu",children:[e.jsxs("button",{className:"export-menu-item",onClick:()=>g("pdf"),children:[e.jsx("span",{children:"üìÑ"})," PDF"]}),e.jsxs("button",{className:"export-menu-item",onClick:()=>g("markdown"),children:[e.jsx("span",{children:"üìù"})," Markdown"]})]})]}),e.jsxs("button",{className:"btn btn-ghost",onClick:()=>i(!a),style:{fontSize:"12px"},children:["üêõ ",a?"Hide":"Show"," Debug"]}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>u.resetAnalysis(),children:"üîÑ New Analysis"})]})]}),a&&e.jsxs("div",{style:{background:"#1e293b",color:"#e2e8f0",padding:"16px",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",maxHeight:"300px",overflow:"auto"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",color:"#94a3b8"},children:"üêõ Debug: Raw Analysis Data"}),e.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:JSON.stringify(o,null,2)})]}),e.jsx("div",{className:"report-tabs",children:at.map(f=>e.jsxs("button",{className:`report-tab ${r===f.id?"active":""}`,onClick:()=>u.setActiveTab(f.id),children:[e.jsx("span",{className:"report-tab-icon",children:f.icon}),f.name]},f.id))}),e.jsx("div",{className:"report-content",children:b()})]})}function cs({analysis:S}){var t,a,i;const l=(S==null?void 0:S.sessionOverview)||{},r=l.turnAnalysis||{},u=l.timePatterns||{},s=(S==null?void 0:S.dataQualityNotes)||{};return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"üìä Session Overview"}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Total Sessions"}),e.jsx("div",{className:"metric-value positive",children:l.totalSessions||"N/A"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Date Range"}),e.jsxs("div",{className:"metric-value",style:{fontSize:"16px"},children:[((t=l.dateRange)==null?void 0:t.start)||"N/A"," ‚Üí ",((a=l.dateRange)==null?void 0:a.end)||"N/A"]}),e.jsxs("div",{className:"metric-trend",children:[((i=l.dateRange)==null?void 0:i.totalDays)||0," days"]})]})]}),e.jsx("h4",{style:{marginBottom:"16px",color:"var(--text-secondary)"},children:"Turn Analysis"}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Single-Turn Sessions"}),e.jsx("div",{className:"metric-value",children:r.singleTurnSessions||0}),e.jsx("div",{className:"metric-trend",children:"1 query & done"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Multi-Turn Sessions"}),e.jsx("div",{className:"metric-value positive",children:r.multiTurnSessions||0}),e.jsx("div",{className:"metric-trend",children:"2+ queries"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Avg Turns/Session"}),e.jsx("div",{className:"metric-value",children:r.avgTurnsPerSession||"N/A"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Max Turns"}),e.jsx("div",{className:"metric-value",children:r.maxTurnsInSession||"N/A"})]})]}),(u.busiestHour||u.busiestDay)&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginBottom:"16px",color:"var(--text-secondary)"},children:"Time Patterns"}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:[u.busiestHour&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Busiest Hour"}),e.jsx("div",{className:"metric-value",children:u.busiestHour})]}),u.busiestDay&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Busiest Day"}),e.jsx("div",{className:"metric-value",children:u.busiestDay})]})]})]}),s.dataLimitations&&e.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"16px",borderRadius:"8px",borderLeft:"4px solid var(--color-warning-400)"},children:[e.jsx("h4",{style:{marginBottom:"8px",color:"var(--color-warning-600)"},children:"‚ö†Ô∏è Data Limitations"}),e.jsx("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--text-secondary)"},children:s.dataLimitations.map((o,g)=>e.jsx("li",{style:{marginBottom:"4px"},children:o},g))}),s.whatWeCannotDetermine&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{style:{marginTop:"12px",marginBottom:"4px",color:"var(--text-tertiary)"},children:"Cannot determine from this data:"}),e.jsx("ul",{style:{margin:0,paddingLeft:"20px",color:"var(--text-tertiary)",fontSize:"13px"},children:s.whatWeCannotDetermine.map((o,g)=>e.jsx("li",{children:o},g))})]})]})]})}function ds({analysis:S}){const[l,r]=ie.useState(""),u=(S==null?void 0:S.queryAnalysis)||{},s=u.allUniqueQueries||[],t=u.queryCategories||[],a=s.filter(i=>{var o;return(o=i.query)==null?void 0:o.toLowerCase().includes(l.toLowerCase())}).sort((i,o)=>(o.frequency||0)-(i.frequency||0));return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"üîç Query Analysis"}),u.overview&&e.jsx("p",{style:{marginBottom:"24px",color:"var(--text-secondary)"},children:u.overview}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Total Queries"}),e.jsx("div",{className:"metric-value",children:u.totalQueries||0})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Unique Queries"}),e.jsx("div",{className:"metric-value",children:u.uniqueQueries||s.length})]})]}),t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginBottom:"16px"},children:"Query Categories"}),e.jsx("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:t.map((i,o)=>e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:i.category}),e.jsx("div",{className:"metric-value",children:i.count}),e.jsxs("div",{className:"metric-trend",children:[i.percentage,"%"]})]},o))})]}),u.topSearchedQueries&&u.topSearchedQueries.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginBottom:"12px"},children:"Top Searched Queries"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"24px"},children:u.topSearchedQueries.map((i,o)=>e.jsxs("span",{className:"badge badge-primary",style:{fontSize:"14px",padding:"6px 12px"},children:[i.query," (",i.frequency,")"]},o))})]}),e.jsxs("h4",{style:{marginBottom:"16px"},children:["All Queries (",s.length,")"]}),e.jsx("input",{type:"text",placeholder:"Search queries...",value:l,onChange:i=>r(i.target.value),style:{width:"100%",maxWidth:"400px",padding:"10px 16px",border:"1px solid var(--border-primary)",borderRadius:"8px",marginBottom:"16px",background:"var(--bg-primary)",color:"var(--text-primary)"}}),a.length>0?e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid var(--border-primary)"},children:"Query"}),e.jsx("th",{style:{padding:"12px",textAlign:"center",width:"100px",borderBottom:"2px solid var(--border-primary)"},children:"Count"})]})}),e.jsx("tbody",{children:a.slice(0,50).map((i,o)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-secondary)"},children:[e.jsx("td",{style:{padding:"12px"},children:i.query}),e.jsx("td",{style:{padding:"12px",textAlign:"center",fontWeight:600},children:i.frequency})]},o))})]}):e.jsx("div",{style:{textAlign:"center",padding:"48px",color:"var(--text-tertiary)",background:"var(--bg-secondary)",borderRadius:"12px"},children:"No queries found"})]})}function us({analysis:S}){const l=(S==null?void 0:S.potentialIssues)||[],r=(S==null?void 0:S.recommendations)||[],u=(S==null?void 0:S.observations)||{},s={high:"badge-danger",medium:"badge-warning",low:"badge-neutral"};return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"‚ö†Ô∏è Potential Issues"}),e.jsx("p",{style:{marginBottom:"16px",color:"var(--text-tertiary)",fontSize:"13px"},children:"Note: These are inferred issues based on patterns in the data. Without engagement data, we cannot confirm impact."}),l.length>0?e.jsx("div",{className:"recommendation-list",style:{marginBottom:"32px"},children:l.map((t,a)=>e.jsxs("div",{className:"recommendation-item",style:{borderLeftColor:t.severity==="high"?"var(--color-danger-500)":t.severity==="medium"?"var(--color-warning-500)":"var(--color-neutral-400)"},children:[e.jsxs("div",{className:"recommendation-header",children:[e.jsx("span",{className:"recommendation-title",children:t.issue}),e.jsx("span",{className:`badge ${s[t.severity]||"badge-neutral"}`,children:t.severity}),e.jsx("span",{className:"badge badge-neutral",children:t.type})]}),t.frequency&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"13px"},children:["Observed: ",t.frequency," times"]}),t.evidence&&e.jsxs("div",{style:{marginTop:"8px",padding:"8px",background:"var(--bg-secondary)",borderRadius:"4px",fontSize:"13px",fontStyle:"italic"},children:['"',t.evidence,'"']}),t.caveat&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"var(--color-warning-600)"},children:["‚ö†Ô∏è ",t.caveat]})]},a))}):e.jsxs("div",{style:{textAlign:"center",padding:"32px",background:"var(--bg-secondary)",borderRadius:"12px",marginBottom:"32px"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"12px"},children:"ü§ñ"}),e.jsx("div",{style:{fontWeight:500,marginBottom:"8px"},children:"No Issues Detected"}),e.jsx("div",{style:{fontSize:"13px",color:"var(--text-tertiary)"},children:"Connect an LLM in the settings to enable AI-powered issue detection and recommendations."})]}),e.jsx("h3",{className:"section-title",children:"üí° Recommendations"}),r.length>0?e.jsx("div",{className:"recommendation-list",children:r.map((t,a)=>e.jsxs("div",{className:"recommendation-item",children:[e.jsxs("div",{className:"recommendation-header",children:[e.jsx("span",{className:"recommendation-number",children:t.id||a+1}),e.jsx("span",{className:"recommendation-title",children:t.title}),e.jsxs("span",{className:`badge ${t.effort==="low"?"badge-success":t.effort==="high"?"badge-danger":"badge-warning"}`,children:[t.effort," effort"]})]}),t.rationale&&e.jsx("div",{style:{marginTop:"8px",color:"var(--text-secondary)"},children:t.rationale}),t.evidence&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"var(--text-tertiary)"},children:["Evidence: ",t.evidence]}),t.action&&e.jsxs("div",{style:{marginTop:"8px",padding:"8px",background:"var(--bg-secondary)",borderRadius:"4px"},children:[e.jsx("strong",{children:"Action:"})," ",t.action]}),t.caveat&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"var(--color-warning-600)"},children:["‚ö†Ô∏è ",t.caveat]})]},a))}):e.jsx("div",{style:{textAlign:"center",padding:"24px",background:"var(--bg-secondary)",borderRadius:"12px"},children:"No recommendations generated"}),u.patterns&&u.patterns.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"section-title",style:{marginTop:"32px"},children:"üëÅÔ∏è Observations"}),e.jsx("div",{className:"recommendation-list",children:u.patterns.map((t,a)=>e.jsxs("div",{className:"recommendation-item",children:[e.jsx("div",{className:"recommendation-title",children:t.observation}),t.evidence&&e.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"var(--text-tertiary)"},children:t.evidence}),t.businessRelevance&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"var(--color-primary-600)"},children:["üìà ",t.businessRelevance]})]},a))})]})]})}function Fe({websiteContent:S,llmEnabled:l}){var b;if(!(S!=null&&S.success))return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"üåê Site Information"}),e.jsxs("div",{style:{textAlign:"center",padding:"48px",background:"var(--bg-secondary)",borderRadius:"12px"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"üåê"}),e.jsx("div",{style:{fontWeight:500,marginBottom:"8px"},children:"No Site Data Available"}),e.jsx("div",{style:{fontSize:"13px",color:"var(--text-tertiary)"},children:'Click "Fetch Content" on the website URL to analyze site structure.'})]})]});const r=S.homepage,u=S.categories||[],s=S.products||[],t=S.sitemap,a=f=>{const p=f==null?void 0:f.match(/^#\s*(.+)$/m);return p?p[1]:null},i=f=>f?f.split(`
`).filter(d=>d.trim()&&!d.startsWith("#")&&!d.startsWith("[")).slice(0,3).join(" ").substring(0,300):null,o=a(r==null?void 0:r.content),g=i(r==null?void 0:r.content);return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"üåê Site Information"}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Data Source"}),e.jsx("div",{className:"metric-value",style:{fontSize:"16px"},children:"Jina AI Reader"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Page URL"}),e.jsx("div",{className:"metric-value",style:{fontSize:"13px",wordBreak:"break-all"},children:(r==null?void 0:r.url)||"N/A"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"AI Analysis"}),e.jsx("div",{className:"metric-value",style:{fontSize:"14px"},children:l?"‚úÖ Enabled":"‚ùå Disabled"})]})]}),o&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h4",{style:{marginBottom:"8px"},children:"Site Title"}),e.jsx("div",{style:{padding:"16px",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"18px",fontWeight:500},children:o})]}),g&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h4",{style:{marginBottom:"8px"},children:"Site Description"}),e.jsxs("div",{style:{padding:"16px",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"14px",color:"var(--text-secondary)"},children:[g,"..."]})]}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"24px"},children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Sitemap URLs"}),e.jsx("div",{className:"metric-value",children:((b=t==null?void 0:t.urls)==null?void 0:b.length)||0}),e.jsx("div",{className:"metric-trend",style:{color:t!=null&&t.success?"var(--color-success-500)":"var(--color-warning-500)"},children:t!=null&&t.success?"Found":"Not found"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Categories Analyzed"}),e.jsx("div",{className:"metric-value",children:u.length})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Products Analyzed"}),e.jsx("div",{className:"metric-value",children:s.length})]})]}),u.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginBottom:"12px"},children:"Category Pages"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"24px"},children:u.map((f,p)=>e.jsxs("div",{style:{padding:"12px 16px",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"13px"},children:[e.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-primary-600)"},children:f.url}),f.success&&e.jsx("span",{className:"badge badge-success",style:{marginLeft:"8px"},children:"‚úì"})]},p))})]}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginBottom:"12px"},children:"Product Pages"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"24px"},children:s.map((f,p)=>e.jsxs("div",{style:{padding:"12px 16px",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"13px"},children:[e.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-primary-600)"},children:f.url}),f.success&&e.jsx("span",{className:"badge badge-success",style:{marginLeft:"8px"},children:"‚úì"})]},p))})]}),(r==null?void 0:r.content)&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginBottom:"12px"},children:"Homepage Content Preview"}),e.jsxs("div",{style:{padding:"16px",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"12px",fontFamily:"monospace",maxHeight:"300px",overflowY:"auto",whiteSpace:"pre-wrap",color:"var(--text-tertiary)"},children:[r.content.substring(0,2e3),r.content.length>2e3&&`

[Content truncated...]`]})]})]})}function hs({userBehavior:S}){var t,a,i,o,g,b,f;if(!S)return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"üë§ User Insights"}),e.jsxs("div",{style:{textAlign:"center",padding:"48px",background:"var(--bg-secondary)",borderRadius:"12px"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"üë§"}),e.jsx("div",{style:{fontWeight:500},children:"No user behavior data available"})]})]});const{queryComplexity:l,repeatedQueries:r,intentCategories:u,insights:s}=S;return e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:"üë§ User Insights"}),e.jsx("p",{style:{color:"var(--text-tertiary)",marginBottom:"24px"},children:"Understanding how users interact with your chatbot"}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h4",{style:{marginBottom:"16px"},children:"Query Complexity"}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Single Word"}),e.jsx("div",{className:"metric-value",children:(l==null?void 0:l.singleWord)||0}),e.jsxs("div",{className:"metric-trend",children:[((t=l==null?void 0:l.percentages)==null?void 0:t.singleWord)||0,"%"]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Simple Phrase"}),e.jsx("div",{className:"metric-value",children:(l==null?void 0:l.simplePhrase)||0}),e.jsxs("div",{className:"metric-trend",children:[((a=l==null?void 0:l.percentages)==null?void 0:a.simplePhrase)||0,"%"]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Advanced Search"}),e.jsx("div",{className:"metric-value",children:(l==null?void 0:l.advancedSearch)||0}),e.jsxs("div",{className:"metric-trend positive",children:[((i=l==null?void 0:l.percentages)==null?void 0:i.advancedSearch)||0,"%"]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Natural Language"}),e.jsx("div",{className:"metric-value",children:(l==null?void 0:l.naturalLanguage)||0}),e.jsxs("div",{className:"metric-trend positive",children:[((o=l==null?void 0:l.percentages)==null?void 0:o.naturalLanguage)||0,"%"]})]})]}),(l==null?void 0:l.examples)&&e.jsxs("div",{style:{marginTop:"16px",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:[((g=l.examples.singleWord)==null?void 0:g.length)>0&&e.jsxs("div",{style:{padding:"12px",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"var(--text-tertiary)",marginBottom:"8px"},children:"Single Word Examples"}),l.examples.singleWord.slice(0,3).map((p,d)=>e.jsxs("div",{style:{fontSize:"13px",marginBottom:"4px"},children:['"',p,'"']},d))]}),((b=l.examples.advancedSearch)==null?void 0:b.length)>0&&e.jsxs("div",{style:{padding:"12px",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"var(--text-tertiary)",marginBottom:"8px"},children:"Advanced Search Examples"}),l.examples.advancedSearch.slice(0,3).map((p,d)=>e.jsxs("div",{style:{fontSize:"13px",marginBottom:"4px"},children:['"',p,'"']},d))]})]})]}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h4",{style:{marginBottom:"16px"},children:"User Intent Categories"}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Product Search"}),e.jsx("div",{className:"metric-value",children:(u==null?void 0:u.productSearch)||0})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Location Query"}),e.jsx("div",{className:"metric-value",children:(u==null?void 0:u.locationQuery)||0})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Category Browse"}),e.jsx("div",{className:"metric-value",children:(u==null?void 0:u.categoryBrowse)||0})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Support Request"}),e.jsx("div",{className:"metric-value",style:{color:(u==null?void 0:u.supportRequest)>0?"var(--color-warning-500)":"inherit"},children:(u==null?void 0:u.supportRequest)||0})]})]})]}),(r==null?void 0:r.sessionsWithRepeats)>0&&e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h4",{style:{marginBottom:"16px"},children:"Repeated Queries"}),e.jsxs("div",{className:"metrics-grid",style:{marginBottom:"16px"},children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Sessions with Repeats"}),e.jsx("div",{className:"metric-value",style:{color:"var(--color-warning-500)"},children:r.sessionsWithRepeats}),e.jsxs("div",{className:"metric-trend",children:[r.percentage,"% of sessions"]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Total Repeat Queries"}),e.jsx("div",{className:"metric-value",children:r.totalRepeats})]})]}),((f=r.examples)==null?void 0:f.length)>0&&e.jsxs("div",{style:{padding:"16px",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"var(--text-tertiary)",marginBottom:"12px"},children:"Examples of Repeated Queries"}),r.examples.slice(0,5).map((p,d)=>e.jsxs("div",{style:{fontSize:"13px",marginBottom:"8px",padding:"8px",background:"var(--bg-primary)",borderRadius:"4px"},children:[e.jsxs("strong",{children:['"',p.query,'"']})," - repeated ",p.count,"x in session"]},d))]})]}),(s==null?void 0:s.length)>0&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"16px"},children:"Key Insights"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:s.map((p,d)=>e.jsxs("div",{style:{padding:"16px",background:p.type==="warning"?"rgba(245, 158, 11, 0.1)":p.type==="positive"?"rgba(16, 185, 129, 0.1)":"var(--bg-secondary)",borderRadius:"8px",borderLeft:`4px solid ${p.type==="warning"?"var(--color-warning-500)":p.type==="positive"?"var(--color-success-500)":"var(--color-primary-500)"}`},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:"8px"},children:[p.type==="warning"?"‚ö†Ô∏è":p.type==="positive"?"‚úÖ":"‚ÑπÔ∏è"," ",p.title]}),e.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"8px"},children:p.message}),p.recommendation&&e.jsxs("div",{style:{fontSize:"13px",color:"var(--color-primary-600)"},children:["üí° ",p.recommendation]})]},d))})]})]})}function ps(){const{state:S}=_e(),{analysis:l,results:r,parsedTranscripts:u,llmConfig:s}=S,t=a=>{if(r)return"completed";switch(a){case 1:return s.isConnected?"completed":"active";case 2:return s.isConnected?u.length>0?"completed":"active":"pending";case 3:return u.length>0?"active":"pending";case 4:return r?"completed":"pending";default:return"pending"}};return e.jsxs("div",{className:"app",children:[e.jsx(ct,{}),e.jsxs("main",{className:"app-main",children:[e.jsxs("div",{className:"step-indicator",children:[e.jsxs("div",{className:`step-dot ${t(1)}`,children:[e.jsx("div",{className:"step-dot-circle",children:t(1)==="completed"?"‚úì":"1"}),e.jsx("span",{className:"step-dot-label",children:"Configure"})]}),e.jsx("div",{className:`step-line ${t(1)==="completed"?"completed":""}`}),e.jsxs("div",{className:`step-dot ${t(2)}`,children:[e.jsx("div",{className:"step-dot-circle",children:t(2)==="completed"?"‚úì":"2"}),e.jsx("span",{className:"step-dot-label",children:"Upload"})]}),e.jsx("div",{className:`step-line ${t(2)==="completed"?"completed":""}`}),e.jsxs("div",{className:`step-dot ${t(3)}`,children:[e.jsx("div",{className:"step-dot-circle",children:t(3)==="completed"?"‚úì":"3"}),e.jsx("span",{className:"step-dot-label",children:"Analyze"})]}),e.jsx("div",{className:`step-line ${t(4)==="completed"?"completed":""}`}),e.jsxs("div",{className:`step-dot ${t(4)}`,children:[e.jsx("div",{className:"step-dot-circle",children:t(4)==="completed"?"‚úì":"4"}),e.jsx("span",{className:"step-dot-label",children:"Results"})]})]}),r?e.jsx("div",{className:"results-mode",children:e.jsx(qe,{children:e.jsx(ls,{})})}):e.jsxs("div",{className:"workflow",children:[e.jsxs("div",{className:"analysis-layout",children:[e.jsx("div",{className:"workflow-step",children:e.jsx(ut,{})}),e.jsx("div",{className:"workflow-step",children:e.jsx(Ot,{})})]}),e.jsx("div",{className:"workflow-step",children:e.jsx(ss,{})})]}),l.isRunning&&e.jsx("div",{className:"analysis-overlay",children:e.jsx("div",{className:"analysis-overlay-content",children:e.jsx(rs,{currentStage:l.currentStage,progress:l.progress,error:l.error})})})]}),e.jsx("footer",{className:"app-footer",children:e.jsx("p",{className:"app-footer-text",children:"Chatbot Transcript Analyzer ‚Äî Built for Leadership Teams"})})]})}function fs(){return e.jsx(qe,{children:e.jsx(lt,{children:e.jsx(ps,{})})})}We(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(fs,{})}));
